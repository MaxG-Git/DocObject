var Doc;(()=>{"use strict";var t={360:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=n(391);e.default=class{constructor(t){return this.obj=t,new Proxy(this,{get:(t,e)=>this.Gen(e)})}Gen(t){return(e=[],n)=>{if(this.obj&&t in this.obj.binds){const r=this.obj.binds[t](this.obj.values,n,i.DocObject.toNodeArray(e));return"function"==typeof r?r(this.obj.g):r}let r=document.createElement(t);for(let t in n)if("style"===t&&"object"==typeof n[t])for(let e in n[t])r.style[e]=n[t][e];else t.startsWith("on")?r[t]=n[t]:r.setAttribute(t,n[t]);return i.DocObject.toNodeArray(e).forEach((t=>{r.appendChild(t)})),r}}}},391:function(t,e,n){var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.DocObject=void 0;const c=s(n(360)),a=o(n(382));class u{constructor(t,e){this.querySelectorAll=t=>this.root.querySelectorAll(t);const{elements:n,values:i,render:r,binds:o,bindAttr:s,bindInAttr:d,isJQuery:l,connections:h,removeOnload:f}=u.defaultParams(e);let b=u.toNodeArray(t)[0];b instanceof HTMLElement?this.root=b:(0,a.default)(a.ROOT_ERROR,!0),this._connections=h,l&&window.jQuery?(this._isJQuery=!0,this._querySelect=(...t)=>$(this.root).find(...t)):(l&&(0,a.default)(a.JQUERY_NOT_DETECTED,!1),this._isJQuery=!1,this._querySelect=(...t)=>this.root.querySelectorAll(...t)),this.root._DocObject=this,this.render=r,this.g=new c.default(this),this.binds="function"==typeof o?o(this.g):o,this.bindAttr=s,this.bindInAttr=d,this.query=new Proxy({},{get:(t,e)=>{if("string"==typeof e)return t[e]?t[e]:t=>this._querySelect(/.*(\.|\#|\[|\]).*/gm.exec(e)?e:"#"+e)},set:(t,e,n,i)=>("string"==typeof n&&(n=()=>this._querySelect(n)),"string"==typeof e&&(t[e]=t=>n),!0)}),this.elements=new Proxy(this.query,{get:(t,e)=>t[e]()}),n&&Object.entries(n).forEach((t=>{this.query[t[0]]=t[1]})),this._values=new Proxy(i&&"object"==typeof i?i:{},{set:(t,e,n,i)=>(this.runRender({[e]:n}),t[e]=n,this.runConnections({[e]:n}),!0)}),this.onLoad=()=>{this.runRender({[!0]:!0}),this.runConnections(this.values)},f||(this._isJQuery?$(this.onLoad):window.onload=this.onLoad)}static toNodeArray(t){return"string"==typeof t||"number"==typeof t?[...u.parser.parseFromString(t.toString(),"text/html").body.childNodes]:NodeList.prototype.isPrototypeOf(t)||window.jQuery&&t instanceof jQuery?[...t]:Array.isArray(t)?t.filter((t=>"string"==typeof t||t instanceof Node)).map((t=>"string"==typeof t?u.toNodeArray(t)[0]:t)):t instanceof Node||t instanceof Document?[t]:void 0}static defaultParams({render:t=[],binds:e={},elements:n={},values:i={},bindAttr:r="d-bind",bindInAttr:o="d-bind-in",isJQuery:s=!1,connections:c=[],removeOnload:a=!1}={}){return{elements:n,values:i,render:t,binds:e,bindAttr:r,bindInAttr:o,isJQuery:s,connections:c,removeOnload:a}}defaultRunBindOptions({root:t,valueChanges:e,additionalHosts:n=[]}){return{root:t,valueChanges:e,additionalHosts:n}}set values(t){throw Error("Tried to set DocObject.value. Try creating a inner object instead.")}get values(){return this._values}isBindIn(t){return t.getAttribute(this.bindInAttr)&&!0}isBind(t){return("d-bind"===t.localName||t.getAttribute(this.bindAttr))&&!0}static isDobObjectElement(t){return t._DocObject instanceof u}findOrRegisterBind(t){if(void 0===t._DocObjectConfig){let e=[...t.childNodes];e.toString=()=>t.innerHTML,t._DocObjectConfig={originalChildren:e,originalChildrenHTML:t.innerHTML,originalAttributes:[...t.attributes].reduce(((t,e)=>Object.assign(Object.assign({},t),{[e.name]:e.value})),{})}}return t._DocObjectConfig}generateBind(t,e,n){const i=t._DocObjectConfig,r=u.toNodeArray("function"==typeof n?n(this.g):n);if(this.isBind(t)){const t=r.find((t=>t instanceof HTMLElement));return t._DocObjectConfig=i,t.setAttribute("d-bind"===t.localName?"to":this.bindAttr,e),Object.entries(i.originalAttributes).filter((t=>!["d-bind-in","to"].includes(t[0]))).forEach((e=>t.setAttribute(e[0],e[1]))),t}return r}runRender(t={}){this.render.filter((e=>e.dep&&Array.isArray(e.dep)&&e.dep.some((e=>e in t))||void 0===e.dep)).forEach((e=>{e.clean&&e.clean(Object.assign(Object.assign({},this.values),t),this.values),e.action(Object.assign(Object.assign({},this.values),t),this.values)})),this.runBinds({root:this.root,valueChanges:t,additionalHosts:[this.root]})}getBindAction(t){if(this.isBind(t)){if(t.getAttribute(this.bindAttr))return[t.getAttribute(this.bindAttr),e=>t.parentNode.replaceChild(e,t)];if("d-bind"===t.localName)return[t.getAttribute("to"),e=>t.parentNode.replaceChild(e,t)]}else{if(this.isBindIn(t))return[t.getAttribute(this.bindInAttr),e=>{t.innerHTML="";for(let n of e)t.appendChild(n)}];if(u.isDobObjectElement(t))return["this",e=>{t.innerHTML="";for(let n of e)t.appendChild(n)}]}}runBinds(t){const{root:e,valueChanges:n,additionalHosts:i}=this.defaultRunBindOptions(t);return(Array.isArray(e)?e:[e]).filter((t=>t&&t instanceof HTMLElement)).forEach((t=>{[...t.querySelectorAll(`[${this.bindAttr}], [${this.bindInAttr}], d-bind[to]`),...i].forEach((t=>{const[e,i]=this.getBindAction(t);if(e in this.binds){const r=this.findOrRegisterBind(t);i(this.runBinds({root:this.generateBind(t,e,this.binds[e](Object.assign(Object.assign({},this.values),n),r.originalAttributes,r.originalChildren)),valueChanges:n}))}}))})),e}runConnections(t={[!0]:!0}){for(let e in t)this._connections.forEach((n=>n.values[e]=t[e]))}connect(...t){return this._connections=[...this._connections,...t],this.runConnections(this.values),this}}e.DocObject=u,u.parser=new DOMParser},382:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.JQUERY_NOT_DETECTED=e.ROOT_ERROR=void 0,e.ROOT_ERROR="ROOT_ERROR",e.JQUERY_NOT_DETECTED="JQUERY_NOT_DETECTED",e.default=function(t,e=!1){if(t in n){if(e)throw Error("DocObject: "+n[t].message);console.error(n[t].message)}};const n={ROOT_ERROR:{message:"Root Element Must be a valid Node, Or jQuery Element"},JQUERY_NOT_DETECTED:{message:"JQuery is not detected. Please load JQuery before DocObject"}}},294:function(t,e,n){var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.gen=e.obj=e.fixInput=void 0;const r=n(391),o=i(n(360)),s=n(605);class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"});const t=document.createElement("div");t.style.display="none",this.shadowRoot.append(t)}}e.fixInput=function(t,e){let n=(0,s.getCursorPos)(t()[0]);e(),(0,s.setCursorPos)(t()[0],n)},window.customElements.define("d-bind",c),window.jQuery&&jQuery.fn.extend({DocObject:function(t=null){return this[0]._DocObject&&!t||(this.each((function(){new r.DocObject(this,t)})),new r.DocObject(this,Object.assign({isJQuery:!0},t))),this[0]._DocObject}}),e.obj=function(t,e){return new r.DocObject(t,e)},e.gen=function(){return new o.default}},605:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setCursorPos=e.getCursorPos=void 0,e.getCursorPos=function(t){return"backward"==t.selectionDirection?t.selectionStart:t.selectionEnd},e.setCursorPos=function(t,e){if(t.setSelectionRange)t.focus(),t.setSelectionRange(e,e);else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}}}},e={},n=function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}(294);Doc=n})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SSxFQUFBZixVQUFVYyxFQUFNQyxJQUcvQixpQkFDSSxPQUFPLElBQUksWSxrR0NwQ2Qsd0JBQTZCWixHQUt0QixNQUFxQyxZQUE5QkEsRUFBUXlJLG1CQUFtQ3pJLEVBQVEwSSxlQUFpQjFJLEVBQVEySSxjQUkzRix3QkFBNkIzSSxFQUE0QmlJLEdBRXJELEdBQUlqSSxFQUFRNEksa0JBQ1o1SSxFQUFRNkksUUFDUjdJLEVBQVE0SSxrQkFBa0JYLEVBQUtBLFFBR3hCLEdBQUtqSSxFQUFnQjhJLGdCQUFpQixDQUMzQyxJQUFJQyxFQUFTL0ksRUFBZ0I4SSxrQkFDN0JDLEVBQU1DLFVBQVMsR0FDZkQsRUFBTUUsUUFBUSxZQUFhaEIsR0FDM0JjLEVBQU1HLFVBQVUsWUFBYWpCLEdBQzdCYyxFQUFNSSxhQzNCUkMsRUFBMkIsR0NFM0JDLEVEQ0osU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVKLEVBQXlCRyxHQUM1QyxRQUFxQjNFLElBQWpCNEUsRUFDSCxPQUFPQSxFQUFhQyxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkcsR0FBWSxDQUdqREUsUUFBUyxJQU9WLE9BSEFFLEVBQW9CSixHQUFVSyxLQUFLRixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTSCxHQUdwRUksRUFBT0QsUUNsQldILENBQW9CLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Eb2MvLi9zcmMvdHMvZG9jZ2VuLnRzIiwid2VicGFjazovL0RvYy8uL3NyYy90cy9kb2NvYmplY3QudHMiLCJ3ZWJwYWNrOi8vRG9jLy4vc3JjL3RzL2Vycm9ycy50cyIsIndlYnBhY2s6Ly9Eb2MvLi9zcmMvdHMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vRG9jLy4vc3JjL3RzL3V0aWxzLnRzIiwid2VicGFjazovL0RvYy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Eb2Mvd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RG9jT2JqZWN0LCBEb2NPYmplY3RIVE1MTGlrZX0gZnJvbSAnLi9kb2NvYmplY3QnXHJcbmltcG9ydCB7IERvY09iamVjdEJpbmRBdHRyaWJ1dGUgfSBmcm9tICcuL2RvY2JpbmQnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEb2NHZW4ge1xyXG4gICAgXHJcbiAgICBvYmogPyA6IERvY09iamVjdCBcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3Iob2JqPyA6IERvY09iamVjdCl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5vYmogPSBvYmpcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm94eSh0aGlzLCB7XHJcbiAgICAgICAgICAgIGdldDoodGFyZ2V0LCBwcm9wICkgPT4ge1xyXG4gICAgICAgICAgICAgICByZXR1cm4gdGhpcy5HZW4ocHJvcCBhcyBzdHJpbmcpXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuICAgIEdlbihwcm9wIDogc3RyaW5nKXtcclxuICAgICAgICByZXR1cm4gKGlubmVyIDogRG9jT2JqZWN0SFRNTExpa2UgfCBBcnJheTxzdHJpbmd8Tm9kZT4gPSBbXSAsIGF0dHJzIDogRG9jT2JqZWN0QmluZEF0dHJpYnV0ZSkgPT4ge1xyXG4gICAgICAgICAgICBpZih0aGlzLm9iaiAmJiBwcm9wIGluIHRoaXMub2JqLmJpbmRzKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kID0gdGhpcy5vYmouYmluZHNbcHJvcF0odGhpcy5vYmoudmFsdWVzLCBhdHRycywgRG9jT2JqZWN0LnRvTm9kZUFycmF5KGlubmVyKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYm91bmQgPT09ICdmdW5jdGlvbicgPyBib3VuZCh0aGlzLm9iai5nKSA6IGJvdW5kO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChwcm9wKVxyXG4gICAgICAgICAgICBmb3IobGV0IGtleSBpbiBhdHRycyl7XHJcbiAgICAgICAgICAgICAgICBpZihrZXkgPT09ICdzdHlsZScgJiYgdHlwZW9mIGF0dHJzW2tleV0gPT09ICdvYmplY3QnICl7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBza2V5IGluIGF0dHJzW2tleSBhcyBzdHJpbmddKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZVtza2V5XSA9IGF0dHJzW2tleV1bc2tleV1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoa2V5LnN0YXJ0c1dpdGgoJ29uJykpe1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnRba2V5XSA9IGF0dHJzW2tleV1cclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgYXR0cnNba2V5XSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBEb2NPYmplY3QudG9Ob2RlQXJyYXkoaW5uZXIpLmZvckVhY2goaW5lID0+IHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoaW5lKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBEb2NPYmplY3REb21CaW5kLCBEb2NPYmplY3RCaW5kLCBEb2NPYmplY3RCaW5kR2VuIH0gZnJvbSAnLi9kb2NiaW5kJ1xyXG5pbXBvcnQgeyBEb2NPYmplY3RSZW5kZXIgfSBmcm9tICcuL2RvY3JlbmRlcidcclxuaW1wb3J0ICBEb2NHZW4gIGZyb20gJy4vZG9jZ2VuJ1xyXG5pbXBvcnQgcnVuRXJyb3IsIHsgXHJcbiAgICBST09UX0VSUk9SLFxyXG4gICAgSlFVRVJZX05PVF9ERVRFQ1RFRFxyXG59IGZyb20gJy4vZXJyb3JzJztcclxuXHJcbi8qKioqKioqIEdMT0JBTFMgKioqKioqKi9cclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XHJcbiAgICAgICAgalF1ZXJ5OmFueTtcclxuICAgICAgICBtc0NyeXB0bzphbnk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG4vKioqKioqKiBET0MgT0JKRUNUICoqKioqKiovXHJcbmV4cG9ydCB0eXBlIERvY09iamVjdEhUTUxMaWtlID0gXHJcbnwgTm9kZVxyXG58IE5vZGVMaXN0XHJcbnwgSlF1ZXJ5IFxyXG58IE51bWJlclxyXG58IHN0cmluZ1xyXG58ICgoZ2VuOiBEb2NHZW4pID0+IERvY09iamVjdEhUTUxMaWtlKTtcclxuXHJcblxyXG5cclxuaW50ZXJmYWNlIERvY09iamVjdE9wdGlvbnMge1xyXG4gICAgcmVuZGVyIDogRG9jT2JqZWN0UmVuZGVyO1xyXG4gICAgYmluZHMgOiBEb2NPYmplY3RCaW5kIHwgRG9jT2JqZWN0QmluZEdlbjtcclxuICAgIGVsZW1lbnRzIDoge1trZXk6c3RyaW5nXTogc3RyaW5nfTtcclxuICAgIHZhbHVlcyA6IG9iamVjdDtcclxuICAgIGJpbmRBdHRyIDogc3RyaW5nO1xyXG4gICAgYmluZEluQXR0ciA6IHN0cmluZztcclxuICAgIGlzSlF1ZXJ5IDogYm9vbGVhbjtcclxuICAgIGNvbm5lY3Rpb25zIDogQXJyYXk8RG9jT2JqZWN0PlxyXG4gICAgcmVtb3ZlT25sb2FkIDogYm9vbGVhblxyXG59XHJcblxyXG5pbnRlcmZhY2UgRG9jT2JqZWN0UnVuQmluZE9wdGlvbnMge1xyXG4gICAgcm9vdCA6IGFueTtcclxuICAgIHZhbHVlQ2hhbmdlczogb2JqZWN0O1xyXG4gICAgYWRkaXRpb25hbEhvc3RzPyA6IEFycmF5PEhUTUxFbGVtZW50PlxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERvY09iamVjdEVsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XHJcbiAgICBfRG9jT2JqZWN0PyA6IERvY09iamVjdFxyXG59XHJcblxyXG5pbnRlcmZhY2UgRG9jT2JqZWN0RWxlbWVudHMge1xyXG4gICAgW2tleTogc3RyaW5nXSA6IHN0cmluZyB8ICgoc2VsZWN0b3IgOiBzdHJpbmcgKSA9PiBOb2RlTGlzdHxKUXVlcnkpXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRG9jT2JqZWN0Q29uZmlnIHtcclxuICAgIG9yaWdpbmFsQ2hpbGRyZW46IEFycmF5PE5vZGU+O1xyXG4gICAgb3JpZ2luYWxDaGlsZHJlbkhUTUw6IHN0cmluZztcclxuICAgIG9yaWdpbmFsQXR0cmlidXRlczoge1trZXk6c3RyaW5nXSA6IHN0cmluZ307XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgRG9jT2JqZWN0IHtcclxuXHJcbiAgICBzdGF0aWMgcGFyc2VyIDogRE9NUGFyc2VyID0gbmV3IERPTVBhcnNlcigpXHJcblxyXG4gICAgc3RhdGljIHRvTm9kZUFycmF5KGFueSA6IERvY09iamVjdEhUTUxMaWtlIHwgQXJyYXk8c3RyaW5nfE5vZGU+ICkgOiBBcnJheTxOb2RlPiB7XHJcbiAgICAgICAgaWYodHlwZW9mIGFueSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIGFueSA9PT0gJ251bWJlcicpe1xyXG4gICAgICAgICAgICByZXR1cm4gWy4uLkRvY09iamVjdC5wYXJzZXIucGFyc2VGcm9tU3RyaW5nKGFueS50b1N0cmluZygpLCAndGV4dC9odG1sJykuYm9keS5jaGlsZE5vZGVzXVxyXG4gICAgICAgIH1lbHNlIGlmKE5vZGVMaXN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGFueSkgfHwgKHdpbmRvdy5qUXVlcnkgJiYgYW55IGluc3RhbmNlb2YgalF1ZXJ5KSl7XHJcbiAgICAgICAgICAgIHJldHVybiBbIC4uLihhbnkgYXMgTm9kZUxpc3QpXVxyXG4gICAgICAgIH1lbHNlIGlmKEFycmF5LmlzQXJyYXkoYW55KSl7XHJcbiAgICAgICAgICAgIHJldHVybiBhbnlcclxuICAgICAgICAgICAgLmZpbHRlcihlPT4gKHR5cGVvZiBlID09PSAnc3RyaW5nJykgfHwgZSBpbnN0YW5jZW9mIE5vZGUgKVxyXG4gICAgICAgICAgICAubWFwKGU9PiAodHlwZW9mIGUgPT09ICdzdHJpbmcnKSA/IERvY09iamVjdC50b05vZGVBcnJheShlKVswXSA6IGUgKTtcclxuICAgICAgICB9IGVsc2UgaWYoYW55IGluc3RhbmNlb2YgTm9kZSB8fCBhbnkgaW5zdGFuY2VvZiBEb2N1bWVudCApe1xyXG4gICAgICAgICAgICByZXR1cm4gW2FueV1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGRlZmF1bHRQYXJhbXMoe1xyXG4gICAgICAgIHJlbmRlciA9IFtdLFxyXG4gICAgICAgIGJpbmRzID0ge30sXHJcbiAgICAgICAgZWxlbWVudHMgPSB7fSxcclxuICAgICAgICB2YWx1ZXMgPSB7fSxcclxuICAgICAgICBiaW5kQXR0ciA9ICdkLWJpbmQnLFxyXG4gICAgICAgIGJpbmRJbkF0dHIgPSAnZC1iaW5kLWluJyxcclxuICAgICAgICBpc0pRdWVyeSA9IGZhbHNlLFxyXG4gICAgICAgIGNvbm5lY3Rpb25zID0gW10sXHJcbiAgICAgICAgcmVtb3ZlT25sb2FkID0gZmFsc2VcclxuICAgIH0gPSB7fSkgOiBEb2NPYmplY3RPcHRpb25zIHtcclxuICAgICAgICByZXR1cm4gIHsgZWxlbWVudHMsIHZhbHVlcywgcmVuZGVyLCBiaW5kcywgYmluZEF0dHIsIGJpbmRJbkF0dHIsIGlzSlF1ZXJ5LCBjb25uZWN0aW9ucywgcmVtb3ZlT25sb2FkIH0gXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRlZmF1bHRSdW5CaW5kT3B0aW9ucyh7XHJcbiAgICAgICAgcm9vdCxcclxuICAgICAgICB2YWx1ZUNoYW5nZXMsXHJcbiAgICAgICAgYWRkaXRpb25hbEhvc3RzID0gW11cclxuICAgIH0gOiBEb2NPYmplY3RSdW5CaW5kT3B0aW9ucyApIDogRG9jT2JqZWN0UnVuQmluZE9wdGlvbnMge1xyXG4gICAgICAgIHJldHVybiB7cm9vdCwgdmFsdWVDaGFuZ2VzLCBhZGRpdGlvbmFsSG9zdHN9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgcmVhZG9ubHkgX3ZhbHVlcyA6IG9iamVjdDtcclxuICAgIGVsZW1lbnRzIDogUHJveHlIYW5kbGVyPERvY09iamVjdEVsZW1lbnRzPjtcclxuICAgIHJvb3QgOiBEb2NPYmplY3RFbGVtZW50O1xyXG4gICAgcmVuZGVyIDogRG9jT2JqZWN0UmVuZGVyO1xyXG4gICAgYmluZHMgOiBEb2NPYmplY3RCaW5kO1xyXG4gICAgYmluZEF0dHIgOiBzdHJpbmc7XHJcbiAgICBiaW5kSW5BdHRyIDogc3RyaW5nO1xyXG4gICAgcXVlcnkgOiBQcm94eUhhbmRsZXI8RG9jT2JqZWN0RWxlbWVudHM+O1xyXG4gICAgX3F1ZXJ5U2VsZWN0IDogKHNlbGVjdG9yOnN0cmluZyk9PiBOb2RlTGlzdCB8IEpRdWVyeTtcclxuICAgIF9pc0pRdWVyeSA6IGJvb2xlYW5cclxuICAgIF9jb25uZWN0aW9ucyA6IEFycmF5PERvY09iamVjdD5cclxuICAgIGcgOiBEb2NHZW5cclxuICAgIG9uTG9hZDogKCk9PnZvaWRcclxuXHJcbiAgICBzZXQgdmFsdWVzKHZhbHVlcykge1xyXG4gICAgICAgIHRocm93IEVycm9yKFwiVHJpZWQgdG8gc2V0IERvY09iamVjdC52YWx1ZS4gVHJ5IGNyZWF0aW5nIGEgaW5uZXIgb2JqZWN0IGluc3RlYWQuXCIpXHJcbiAgICB9XHJcbiAgICBnZXQgdmFsdWVzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl92YWx1ZXM7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3Iocm9vdCA6IERvY09iamVjdEVsZW1lbnQgfCBKUXVlcnksIG9wdGlvbnMgOiBvYmplY3QpIHtcclxuICAgICAgICAvL0FkZCBEZWZhdWx0IFBhcmFtZXRlcnMgdG8gb3B0aW9uc1xyXG4gICAgICAgIGNvbnN0IHsgZWxlbWVudHMsIHZhbHVlcywgcmVuZGVyLCBiaW5kcywgYmluZEF0dHIsIGJpbmRJbkF0dHIsIGlzSlF1ZXJ5LCBjb25uZWN0aW9ucywgcmVtb3ZlT25sb2FkIH0gOiBEb2NPYmplY3RPcHRpb25zID0gRG9jT2JqZWN0LmRlZmF1bHRQYXJhbXMob3B0aW9ucylcclxuICAgICAgICBcclxuICAgICAgICAvL0V4dHJhY3QgRE9NIGVsZW1lbnQgZnJvbSBIVE1MRWxlbWVudCBPciBKcXVlcnkgT2JqZWN0XHJcbiAgICAgICAgbGV0IHJvb3RFbGVtZW50ID0gRG9jT2JqZWN0LnRvTm9kZUFycmF5KHJvb3QpWzBdXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9TZXQgUm9vdCBPYmplY3RcclxuICAgICAgICBpZihyb290RWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICl7XHJcbiAgICAgICAgICAgIHRoaXMucm9vdCA9IHJvb3RFbGVtZW50XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJ1bkVycm9yKFJPT1RfRVJST1IsIHRydWUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9jb25uZWN0aW9ucyA9IGNvbm5lY3Rpb25zO1xyXG5cclxuICAgICAgICAvL1NldCBKcXVlcnlcclxuICAgICAgICBpZihpc0pRdWVyeSAmJiB3aW5kb3cualF1ZXJ5KXtcclxuICAgICAgICAgICAgLy9JZiBKcXVlcnkgaXMgZGV0ZWN0ZWQgYW5kIGlzIHNldCB0byBqcXVlcnkgbW9kZS4uLlxyXG4gICAgICAgICAgICB0aGlzLl9pc0pRdWVyeSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAvL1NldCBRdWVyeSBTZWxlY3Qgc3RhdGVtZW50IHRvIHVzZSBqUXVlcnlcclxuICAgICAgICAgICAgdGhpcy5fcXVlcnlTZWxlY3QgPSAoLi4ucHJvcHMpID0+ICQodGhpcy5yb290KS5maW5kKC4uLnByb3BzKVxyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgLy9JZiBKcXVlcnkgaXMgbm90IGRldGVjdGVkLi4uXHJcbiAgICAgICAgICAgIGlmKGlzSlF1ZXJ5KXtcclxuICAgICAgICAgICAgICAgIC8vSWYgc2V0IHRvIGpxdWVyeSBtb2RlLi4uXHJcbiAgICAgICAgICAgICAgICBydW5FcnJvcihKUVVFUllfTk9UX0RFVEVDVEVELCBmYWxzZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvL1NldCBRdWVyeSBTZWxlY3Qgc3RhdGVtZW50IHRvIHVzZSBIVE1MRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsXHJcbiAgICAgICAgICAgIHRoaXMuX2lzSlF1ZXJ5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuX3F1ZXJ5U2VsZWN0ID0gKC4uLnByb3BzKSA9PiB0aGlzLnJvb3QucXVlcnlTZWxlY3RvckFsbCguLi5wcm9wcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vU2V0IFJvb3QgT2JqZWN0IHRvIHRoaXNcclxuICAgICAgICB0aGlzLnJvb3QuX0RvY09iamVjdCA9IHRoaXM7XHJcblxyXG4gICAgICAgIC8vU2V0IFJlbmRlciBGdW5jdGlvbnNcclxuICAgICAgICB0aGlzLnJlbmRlciA9IHJlbmRlcjtcclxuXHJcbiAgICAgICAgLy9DcmVhdGUgUmVsYXRlZCBEb2NHZW5cclxuICAgICAgICB0aGlzLmcgPSBuZXcgRG9jR2VuKHRoaXMpXHJcblxyXG4gICAgICAgIC8vU2V0IEJpbmQgRnVuY3Rpb25zXHJcbiAgICAgICAgdGhpcy5iaW5kcyA9ICh0eXBlb2YgYmluZHMgPT09ICdmdW5jdGlvbicpID8gYmluZHModGhpcy5nKSA6IGJpbmRzIDtcclxuXHJcbiAgICAgICAgLy9TZXQgQmluZCBBdHRyaWJ1dGVcclxuICAgICAgICB0aGlzLmJpbmRBdHRyID0gYmluZEF0dHI7XHJcblxyXG4gICAgICAgIC8vU2V0IEJpbmQgSW4gQXR0cmlidXRlXHJcbiAgICAgICAgdGhpcy5iaW5kSW5BdHRyID0gYmluZEluQXR0cjtcclxuICAgICAgICBcclxuICAgICAgICAvL1NldCBRdWVyeSBQcm94eVxyXG4gICAgICAgIHRoaXMucXVlcnkgPSBuZXcgUHJveHkoe30sIHtcclxuICAgICAgICAgICAgZ2V0OiAodGFyZ2V0LCBwcm9wICkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYodHlwZW9mIHByb3AgPT0gJ3N0cmluZycpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICB0YXJnZXRbcHJvcF0gPyB0YXJnZXRbcHJvcF0gOiBfID0+IHRoaXMuX3F1ZXJ5U2VsZWN0KCAvLiooXFwufFxcI3xcXFt8XFxdKS4qL2dtLmV4ZWMocHJvcCkgPyBwcm9wIDogJyMnICsgcHJvcCApIFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQ6ICh0YXJnZXQsIHByb3AsIHZhbHVlLCByZWNlaXZlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHZhbHVlID0gKCkgPT4gdGhpcy5fcXVlcnlTZWxlY3QodmFsdWUpXHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHByb3AgPT09ICdzdHJpbmcnKXtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXRbcHJvcF0gPSBfID0+IHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvL1NldCBFbGVtZW50cyBQcm94eVxyXG4gICAgICAgIHRoaXMuZWxlbWVudHMgPSBuZXcgUHJveHkodGhpcy5xdWVyeSwge1xyXG4gICAgICAgICAgICBnZXQ6ICh0YXJnZXQsIHByb3ApID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbcHJvcF0oKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy9BZGQgaW4gZWxlbWVudHMgZnJvbSBvcHRpb25zXHJcbiAgICAgICAgaWYgKGVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGVsZW1lbnRzKS5mb3JFYWNoKChlID0+IHsgdGhpcy5xdWVyeVtlWzBdXSA9IGVbMV0gfSkpXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fdmFsdWVzID0gbmV3IFByb3h5KCF2YWx1ZXMgfHwgdHlwZW9mIHZhbHVlcyAhPT0gJ29iamVjdCcgPyB7fSA6IHZhbHVlcywge1xyXG4gICAgICAgICAgICBzZXQ6ICh0YXJnZXQsIHByb3AsIHZhbHVlLCByZWNlaXZlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ydW5SZW5kZXIoeyBbcHJvcF06IHZhbHVlIH0pXHJcbiAgICAgICAgICAgICAgICB0YXJnZXRbcHJvcF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucnVuQ29ubmVjdGlvbnMoe1twcm9wXTp2YWx1ZX0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgXHJcbiAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm9uTG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5ydW5SZW5kZXIoeyBbdHJ1ZSBhcyBhbnldOiB0cnVlIH0pXHJcbiAgICAgICAgICAgIHRoaXMucnVuQ29ubmVjdGlvbnModGhpcy52YWx1ZXMpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighcmVtb3ZlT25sb2FkKXtcclxuICAgICAgICAgICAgaWYodGhpcy5faXNKUXVlcnkpe1xyXG4gICAgICAgICAgICAgICAgJCh0aGlzLm9uTG9hZClcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cub25sb2FkID0gdGhpcy5vbkxvYWRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlzQmluZEluKGVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoIGVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEluQXR0cikgJiYgdHJ1ZSApIFxyXG4gICAgfVxyXG4gICAgaXNCaW5kKGVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoZWxlbWVudC5sb2NhbE5hbWUgPT09ICdkLWJpbmQnIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEF0dHIpKSAmJiB0cnVlXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaXNEb2JPYmplY3RFbGVtZW50KGVsZW1lbnQgOiBEb2NPYmplY3RFbGVtZW50ICkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKCBlbGVtZW50Ll9Eb2NPYmplY3QgaW5zdGFuY2VvZiBEb2NPYmplY3QgIClcclxuICAgIH1cclxuXHJcblxyXG4gICAgZmluZE9yUmVnaXN0ZXJCaW5kKERPTWVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kKSA6IERvY09iamVjdENvbmZpZyB7XHJcbiAgICAgICAgaWYoRE9NZWxlbWVudC5fRG9jT2JqZWN0Q29uZmlnID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBsZXQgb3JpZ2luYWxDaGlsZHJlbiA9IFsuLi5ET01lbGVtZW50LmNoaWxkTm9kZXNdXHJcbiAgICAgICAgICAgIG9yaWdpbmFsQ2hpbGRyZW4udG9TdHJpbmcgPSAoKT0+IERPTWVsZW1lbnQuaW5uZXJIVE1MXHJcbiAgICAgICAgICAgIERPTWVsZW1lbnQuX0RvY09iamVjdENvbmZpZyA9IHtcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsQ2hpbGRyZW4sXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbENoaWxkcmVuSFRNTDogRE9NZWxlbWVudC5pbm5lckhUTUwsXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEF0dHJpYnV0ZXM6IFsuLi5ET01lbGVtZW50LmF0dHJpYnV0ZXNdLnJlZHVjZSggKGEsYyk9PntyZXR1cm4gey4uLmEsIFtjLm5hbWVdOmMudmFsdWV9IH0sIHt9IClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gRE9NZWxlbWVudC5fRG9jT2JqZWN0Q29uZmlnXHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhdGVCaW5kKGVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kLCBiaW5kLCBib3VuZCA6IERvY09iamVjdEhUTUxMaWtlKSA6IERvY09iamVjdERvbUJpbmQgfCBOb2RlW10ge1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZyA9IGVsZW1lbnQuX0RvY09iamVjdENvbmZpZztcclxuICAgICAgICBjb25zdCBub2RlQXJyYXkgPSBEb2NPYmplY3QudG9Ob2RlQXJyYXkodHlwZW9mIGJvdW5kID09PSAnZnVuY3Rpb24nID8gYm91bmQodGhpcy5nKSA6IGJvdW5kKTtcclxuICAgICAgICBpZih0aGlzLmlzQmluZChlbGVtZW50KSl7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0RWxlbWVudCA9IG5vZGVBcnJheS5maW5kKGVsID0+IGVsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIGFzIERvY09iamVjdERvbUJpbmQ7XHJcbiAgICAgICAgICAgIGZpcnN0RWxlbWVudC5fRG9jT2JqZWN0Q29uZmlnID0gY29uZmlnO1xyXG4gICAgICAgICAgICBmaXJzdEVsZW1lbnQuc2V0QXR0cmlidXRlKChmaXJzdEVsZW1lbnQubG9jYWxOYW1lID09PSAnZC1iaW5kJyA/ICd0bycgOiB0aGlzLmJpbmRBdHRyKSwgYmluZClcclxuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29uZmlnLm9yaWdpbmFsQXR0cmlidXRlcykuZmlsdGVyKGF0dEE9PiEoWydkLWJpbmQtaW4nLCAndG8nXS5pbmNsdWRlcyhhdHRBWzBdKSkpLmZvckVhY2goYXR0QT0+Zmlyc3RFbGVtZW50LnNldEF0dHJpYnV0ZShhdHRBWzBdLCBhdHRBWzFdKSlcclxuICAgICAgICAgICAgcmV0dXJuIGZpcnN0RWxlbWVudDtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGVBcnJheTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcblxyXG4gICAgcnVuUmVuZGVyKHZhbHVlQ2hhbmdlcyA9IHt9KSA6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmZpbHRlcihyZW4gPT4gKHJlbi5kZXAgJiYgQXJyYXkuaXNBcnJheShyZW4uZGVwKSAmJiByZW4uZGVwLnNvbWUoKGRlcHApID0+IChkZXBwIGluIHZhbHVlQ2hhbmdlcykpKSB8fCAocmVuLmRlcCA9PT0gdW5kZWZpbmVkKSkuZm9yRWFjaChyZW4gPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVuLmNsZWFuKSByZW4uY2xlYW4oeyAuLi50aGlzLnZhbHVlcywgLi4udmFsdWVDaGFuZ2VzIH0sIHRoaXMudmFsdWVzKVxyXG4gICAgICAgICAgICByZW4uYWN0aW9uKHsgLi4udGhpcy52YWx1ZXMsIC4uLnZhbHVlQ2hhbmdlcyB9LCB0aGlzLnZhbHVlcylcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMucnVuQmluZHMoe3Jvb3Q6dGhpcy5yb290LCB2YWx1ZUNoYW5nZXMsIGFkZGl0aW9uYWxIb3N0czpbdGhpcy5yb290XX0pO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEJpbmRBY3Rpb24oZWxlbWVudCA6IEhUTUxFbGVtZW50KSA6IFtzdHJpbmcsIChyZXBsYWNlIDogTm9kZSAmIE5vZGVMaXN0ICk9PnZvaWRdIHtcclxuICAgICAgICBpZih0aGlzLmlzQmluZChlbGVtZW50KSl7XHJcbiAgICAgICAgICAgIGlmKGVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEF0dHIpKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbZWxlbWVudC5nZXRBdHRyaWJ1dGUodGhpcy5iaW5kQXR0ciksIChyZXBsYWNlKT0+ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChyZXBsYWNlLCBlbGVtZW50KV1cclxuICAgICAgICAgICAgfWVsc2UgaWYoZWxlbWVudC5sb2NhbE5hbWUgPT09ICdkLWJpbmQnKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3RvJyksIChyZXBsYWNlKT0+ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChyZXBsYWNlLCBlbGVtZW50KV1cclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLmlzQmluZEluKGVsZW1lbnQpKXtcclxuICAgICAgICAgICAgcmV0dXJuIFtlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLmJpbmRJbkF0dHIpLCAocmVwbGFjZSk9PntcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBub2RlIG9mIHJlcGxhY2UpIGVsZW1lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgICAgIH1dXHJcbiAgICAgICAgfWVsc2UgaWYoRG9jT2JqZWN0LmlzRG9iT2JqZWN0RWxlbWVudChlbGVtZW50KSl7XHJcbiAgICAgICAgICAgIHJldHVybiBbJ3RoaXMnLCAgIChyZXBsYWNlKT0+e1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IG5vZGUgb2YgcmVwbGFjZSkgZWxlbWVudC5hcHBlbmRDaGlsZChub2RlKTtcclxuICAgICAgICAgICAgfV1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBxdWVyeVNlbGVjdG9yQWxsID0gKHNlbGVjdG9yIDogc3RyaW5nKSA9PiB0aGlzLnJvb3QucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcilcclxuICAgIHJ1bkJpbmRzKHBhcmFtcyA6IERvY09iamVjdFJ1bkJpbmRPcHRpb25zKSB7XHJcbiAgICAgICAgY29uc3Qge3Jvb3QsIHZhbHVlQ2hhbmdlcywgYWRkaXRpb25hbEhvc3RzIH0gPSB0aGlzLmRlZmF1bHRSdW5CaW5kT3B0aW9ucyhwYXJhbXMpO1xyXG4gICAgICAgIChBcnJheS5pc0FycmF5KHJvb3QpID8gcm9vdCA6IFtyb290XSkgXHJcbiAgICAgICAgLmZpbHRlcihydD0+cnQgJiYgcnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudClcclxuICAgICAgICAuZm9yRWFjaCgocnQpPT57XHJcbiAgICAgICAgICAgIFsgLi4uKHJ0LnF1ZXJ5U2VsZWN0b3JBbGwoYFske3RoaXMuYmluZEF0dHJ9XSwgWyR7dGhpcy5iaW5kSW5BdHRyfV0sIGQtYmluZFt0b11gKSksIC4uLmFkZGl0aW9uYWxIb3N0c10gXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKCBlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIC8vR2V0IFRoZSBCaW5kIE1ldGhvZCwgYW5kIHRoZSBGdW5jdGlvbiB0byBpbnNlcnQgSFRNTCBcclxuICAgICAgICAgICAgICAgIGNvbnN0IFtiaW5kLCBiaW5kQWN0aW9uXSA9IHRoaXMuZ2V0QmluZEFjdGlvbihlbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgLy9DaGVjayBpZiBCaW5kIEV4aXN0cyBcclxuICAgICAgICAgICAgICAgIGlmIChiaW5kIGluIHRoaXMuYmluZHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9HZXQgT3IgcmVnaXN0ZXIgQmluZCBUYWcncyBDb25maWdcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5maW5kT3JSZWdpc3RlckJpbmQoZWxlbWVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSW5zZXJ0IEhUTUxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmluZEFjdGlvbih0aGlzLnJ1bkJpbmRzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRoaXMuZ2VuZXJhdGVCaW5kKCAgLy9XcmFwIEJpbmQgTWV0aG9kIHRvIHByZXBhcmUgYmluZCBmb3IgZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1J1biBCaW5kIE1ldGhvZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZHNbYmluZF0oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgLi4udGhpcy52YWx1ZXMsIC4uLnZhbHVlQ2hhbmdlcyB9LCAvL1Bhc3MgaW4gdXBkYXRlcyB2YWx1ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9yaWdpbmFsQXR0cmlidXRlcywgLy9QYXNzIGluIG9yaWdpbmFsIGF0dHJpYnV0ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9yaWdpbmFsQ2hpbGRyZW4sIC8vUGFzcyBpbiBvcmlnaW5hbCBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gcm9vdDtcclxuICAgIH1cclxuXHJcbiAgICBydW5Db25uZWN0aW9ucyh2YWx1ZUNoYW5nZXMgOiB7W2tleSA6IHN0cmluZ3xzeW1ib2xdIDogYW55IH0gPSB7W3RydWUgYXMgYW55XTp0cnVlfSApe1xyXG4gICAgICAgIGZvcihsZXQga3kgaW4gdmFsdWVDaGFuZ2VzKXtcclxuICAgICAgICAgICAgdGhpcy5fY29ubmVjdGlvbnMuZm9yRWFjaCgoY29ubmVjdGVkKSA9PiBjb25uZWN0ZWQudmFsdWVzW2t5XSA9IHZhbHVlQ2hhbmdlc1treV0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBjb25uZWN0KC4uLmRvY09iamVjdHMgOiBbRG9jT2JqZWN0XSl7XHJcbiAgICAgICAgdGhpcy5fY29ubmVjdGlvbnMgPSBbLi4udGhpcy5fY29ubmVjdGlvbnMsIC4uLmRvY09iamVjdHNdXHJcbiAgICAgICAgdGhpcy5ydW5Db25uZWN0aW9ucyh0aGlzLnZhbHVlcyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuLypcclxudmFyIGRvYyA9IG5ldyBEb2NPYmplY3Qoe1xyXG4gICAgdmFsdWVzOiB7XHJcbiAgICB9LFxyXG4gICAgZWxlbWVudHM6e1xyXG5cclxuICAgIH0sXHJcbiAgICBiaW5kczp7XHJcblxyXG4gICAgfSxcclxuICAgIHJlbmRlcjogW1xyXG5cclxuICAgIF1cclxufSk7ICQoZG9jLm9uTG9hZClcclxuKi8iLCJcclxuXHJcbmV4cG9ydCBjb25zdCBST09UX0VSUk9SID0gJ1JPT1RfRVJST1InXHJcbmV4cG9ydCBjb25zdCBKUVVFUllfTk9UX0RFVEVDVEVEID0gJ0pRVUVSWV9OT1RfREVURUNURUQnXHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcnVuRXJyb3IoZXJyb3IgOiBzdHJpbmcsIGZhaWw9ZmFsc2Upe1xyXG4gICAgaWYoZXJyb3IgaW4gRVJST1JTKXtcclxuICAgICAgICBpZihmYWlsKXtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0RvY09iamVjdDogJysgRVJST1JTW2Vycm9yXS5tZXNzYWdlKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihFUlJPUlNbZXJyb3JdLm1lc3NhZ2UpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBFUlJPUlMgPSB7XHJcbiAgICBST09UX0VSUk9SIDoge1xyXG4gICAgICAgIG1lc3NhZ2U6IFwiUm9vdCBFbGVtZW50IE11c3QgYmUgYSB2YWxpZCBOb2RlLCBPciBqUXVlcnkgRWxlbWVudFwiXHJcbiAgICB9LFxyXG4gICAgSlFVRVJZX05PVF9ERVRFQ1RFRDoge1xyXG4gICAgICAgIG1lc3NhZ2UgOiBcIkpRdWVyeSBpcyBub3QgZGV0ZWN0ZWQuIFBsZWFzZSBsb2FkIEpRdWVyeSBiZWZvcmUgRG9jT2JqZWN0XCJcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBEb2NPYmplY3QsIERvY09iamVjdEVsZW1lbnQgfSBmcm9tIFwiLi9kb2NvYmplY3RcIjtcclxuaW1wb3J0IERvY0dlbiBmcm9tIFwiLi9kb2NnZW5cIjtcclxuaW1wb3J0IHtzZXRDdXJzb3JQb3MsIGdldEN1cnNvclBvc30gZnJvbSBcIi4vdXRpbHNcIlxyXG5cclxuY2xhc3MgQmluZCBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKClcclxuICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7bW9kZTogXCJvcGVuXCJ9KTtcclxuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIHRoaXMuc2hhZG93Um9vdC5hcHBlbmQoZGl2KTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqKioqKiogVVRJTElUWSBNRVRIT0RTICoqKioqKiovXHJcbmV4cG9ydCBmdW5jdGlvbiBmaXhJbnB1dChzZWxlY3RvciwgYWN0aW9uKXtcclxuICAgIGxldCBwb3MgPSBnZXRDdXJzb3JQb3Moc2VsZWN0b3IoKVswXSlcclxuICAgIGFjdGlvbigpXHJcbiAgICBzZXRDdXJzb3JQb3Moc2VsZWN0b3IoKVswXSwgcG9zKVxyXG59XHJcblxyXG5cclxud2luZG93LmN1c3RvbUVsZW1lbnRzLmRlZmluZSgnZC1iaW5kJywgQmluZClcclxuaWYod2luZG93LmpRdWVyeSl7XHJcbiAgICAoZnVuY3Rpb24oJCkge1xyXG4gICAgICAgICQuZm4uZXh0ZW5kKHtcclxuICAgICAgICAgICAgRG9jT2JqZWN0IDogZnVuY3Rpb24oIG9wdGlvbnMgPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzWzBdLl9Eb2NPYmplY3QgJiYgIW9wdGlvbnMgKSByZXR1cm4gdGhpc1swXS5fRG9jT2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBEb2NPYmplY3QodGhpcywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG5ldyBEb2NPYmplY3QodGhpcywgeyBpc0pRdWVyeTp0cnVlLCAuLi5vcHRpb25zIH0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1swXS5fRG9jT2JqZWN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pKGpRdWVyeSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvYmoocm9vdCA6IERvY09iamVjdEVsZW1lbnQgfCBKUXVlcnksIG9wdGlvbnMgOiBvYmplY3QpIDogRG9jT2JqZWN0e1xyXG4gICAgcmV0dXJuIG5ldyBEb2NPYmplY3Qocm9vdCwgb3B0aW9ucylcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbigpIDogRG9jR2VuIHtcclxuICAgIHJldHVybiBuZXcgRG9jR2VuKClcclxufVxyXG4iLCJpbnRlcmZhY2UgRG9jdW1lbnQge1xyXG4gICAgc2VsZWN0aW9uOiB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIENyZWRpdHM6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI4OTcxNTUvZ2V0LWN1cnNvci1wb3NpdGlvbi1pbi1jaGFyYWN0ZXJzLXdpdGhpbi1hLXRleHQtaW5wdXQtZmllbGRcclxuIGV4cG9ydCBmdW5jdGlvbiBnZXRDdXJzb3JQb3MoZWxlbWVudCA6IEhUTUxJbnB1dEVsZW1lbnQpIDogbnVtYmVyIHtcclxuICAgIC8vIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcclxuICAgIC8vICAgICBlbGVtZW50LmZvY3VzKCk7XHJcbiAgICAvLyAgICAgcmV0dXJuICBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIC1lbGVtZW50LnZhbHVlLmxlbmd0aCk7XHJcbiAgICAvLyB9XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQuc2VsZWN0aW9uRGlyZWN0aW9uID09ICdiYWNrd2FyZCcgPyBlbGVtZW50LnNlbGVjdGlvblN0YXJ0IDogZWxlbWVudC5zZWxlY3Rpb25FbmQ7XHJcbn1cclxuXHJcbi8vIENyZWRpdHM6IGh0dHA6Ly9ibG9nLnZpc2hhbG9uLm5ldC9pbmRleC5waHAvamF2YXNjcmlwdC1nZXR0aW5nLWFuZC1zZXR0aW5nLWNhcmV0LXBvc2l0aW9uLWluLXRleHRhcmVhL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3Vyc29yUG9zKGVsZW1lbnQgOiBIVE1MSW5wdXRFbGVtZW50LCBwb3MgOiBudW1iZXIpIDogdm9pZCB7XHJcbiAgICAvLyBNb2Rlcm4gYnJvd3NlcnNcclxuICAgIGlmIChlbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKSB7XHJcbiAgICBlbGVtZW50LmZvY3VzKCk7XHJcbiAgICBlbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKHBvcywgcG9zKTtcclxuICAgIFxyXG4gICAgLy8gSUU4IGFuZCBiZWxvd1xyXG4gICAgfSBlbHNlIGlmICgoZWxlbWVudCBhcyBhbnkpLmNyZWF0ZVRleHRSYW5nZSkge1xyXG4gICAgICB2YXIgcmFuZ2UgPSAoZWxlbWVudCBhcyBhbnkpLmNyZWF0ZVRleHRSYW5nZSgpO1xyXG4gICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTtcclxuICAgICAgcmFuZ2UubW92ZUVuZCgnY2hhcmFjdGVyJywgcG9zKTtcclxuICAgICAgcmFuZ2UubW92ZVN0YXJ0KCdjaGFyYWN0ZXInLCBwb3MpO1xyXG4gICAgICByYW5nZS5zZWxlY3QoKTtcclxuICAgIH1cclxufSIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMjk0KTtcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIm9iaiIsInRoaXMiLCJQcm94eSIsImdldCIsInRhcmdldCIsInByb3AiLCJHZW4iLCJpbm5lciIsImF0dHJzIiwiYmluZHMiLCJib3VuZCIsInZhbHVlcyIsIkRvY09iamVjdCIsInRvTm9kZUFycmF5IiwiZyIsImVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJrZXkiLCJza2V5Iiwic3R5bGUiLCJzdGFydHNXaXRoIiwic2V0QXR0cmlidXRlIiwiZm9yRWFjaCIsImluZSIsImFwcGVuZENoaWxkIiwicm9vdCIsIm9wdGlvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2VsZWN0b3IiLCJlbGVtZW50cyIsInJlbmRlciIsImJpbmRBdHRyIiwiYmluZEluQXR0ciIsImlzSlF1ZXJ5IiwiY29ubmVjdGlvbnMiLCJyZW1vdmVPbmxvYWQiLCJkZWZhdWx0UGFyYW1zIiwicm9vdEVsZW1lbnQiLCJIVE1MRWxlbWVudCIsIlJPT1RfRVJST1IiLCJfY29ubmVjdGlvbnMiLCJ3aW5kb3ciLCJqUXVlcnkiLCJfaXNKUXVlcnkiLCJfcXVlcnlTZWxlY3QiLCJwcm9wcyIsIiQiLCJmaW5kIiwiSlFVRVJZX05PVF9ERVRFQ1RFRCIsIl9Eb2NPYmplY3QiLCJxdWVyeSIsIl8iLCJleGVjIiwic2V0IiwidmFsdWUiLCJyZWNlaXZlciIsIk9iamVjdCIsImVudHJpZXMiLCJlIiwiX3ZhbHVlcyIsInJ1blJlbmRlciIsInJ1bkNvbm5lY3Rpb25zIiwib25Mb2FkIiwib25sb2FkIiwic3RhdGljIiwiYW55IiwicGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwidG9TdHJpbmciLCJib2R5IiwiY2hpbGROb2RlcyIsIk5vZGVMaXN0IiwicHJvdG90eXBlIiwiaXNQcm90b3R5cGVPZiIsIkFycmF5IiwiaXNBcnJheSIsImZpbHRlciIsIk5vZGUiLCJtYXAiLCJEb2N1bWVudCIsImRlZmF1bHRSdW5CaW5kT3B0aW9ucyIsInZhbHVlQ2hhbmdlcyIsImFkZGl0aW9uYWxIb3N0cyIsIkVycm9yIiwiaXNCaW5kSW4iLCJnZXRBdHRyaWJ1dGUiLCJpc0JpbmQiLCJsb2NhbE5hbWUiLCJmaW5kT3JSZWdpc3RlckJpbmQiLCJET01lbGVtZW50IiwidW5kZWZpbmVkIiwiX0RvY09iamVjdENvbmZpZyIsIm9yaWdpbmFsQ2hpbGRyZW4iLCJpbm5lckhUTUwiLCJvcmlnaW5hbENoaWxkcmVuSFRNTCIsIm9yaWdpbmFsQXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJyZWR1Y2UiLCJhIiwiYyIsIm5hbWUiLCJnZW5lcmF0ZUJpbmQiLCJiaW5kIiwiY29uZmlnIiwibm9kZUFycmF5IiwiZmlyc3RFbGVtZW50IiwiZWwiLCJhdHRBIiwiaW5jbHVkZXMiLCJyZW4iLCJkZXAiLCJzb21lIiwiZGVwcCIsImNsZWFuIiwiYWN0aW9uIiwicnVuQmluZHMiLCJnZXRCaW5kQWN0aW9uIiwicmVwbGFjZSIsInBhcmVudE5vZGUiLCJyZXBsYWNlQ2hpbGQiLCJub2RlIiwiaXNEb2JPYmplY3RFbGVtZW50IiwicGFyYW1zIiwicnQiLCJiaW5kQWN0aW9uIiwia3kiLCJjb25uZWN0ZWQiLCJjb25uZWN0IiwiZG9jT2JqZWN0cyIsIkRPTVBhcnNlciIsImVycm9yIiwiZmFpbCIsIkVSUk9SUyIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiQmluZCIsInN1cGVyIiwiYXR0YWNoU2hhZG93IiwibW9kZSIsImRpdiIsImRpc3BsYXkiLCJzaGFkb3dSb290IiwiYXBwZW5kIiwicG9zIiwiZ2V0Q3Vyc29yUG9zIiwic2V0Q3Vyc29yUG9zIiwiY3VzdG9tRWxlbWVudHMiLCJkZWZpbmUiLCJmbiIsImV4dGVuZCIsImVhY2giLCJzZWxlY3Rpb25EaXJlY3Rpb24iLCJzZWxlY3Rpb25TdGFydCIsInNlbGVjdGlvbkVuZCIsInNldFNlbGVjdGlvblJhbmdlIiwiZm9jdXMiLCJjcmVhdGVUZXh0UmFuZ2UiLCJyYW5nZSIsImNvbGxhcHNlIiwibW92ZUVuZCIsIm1vdmVTdGFydCIsInNlbGVjdCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19leHBvcnRzX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9