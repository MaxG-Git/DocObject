var Doc;(()=>{"use strict";var e={360:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(391);t.default=class{constructor(e){return this.obj=e,new Proxy(this,{get:(e,t)=>this.Gen(t)})}Gen(e){return(t=[],n)=>{if(this.obj&&e in this.obj.binds)return this.obj.binds[e](this.obj.values,n,i.DocObject.toNodeArray(t));let r=document.createElement(e);for(let e in n)if("style"===e&&"object"==typeof n[e])for(let t in n[e])r.style[t]=n[e][t];else e.startsWith("on")?r[e]=n[e]:r.setAttribute(e,n[e]);return i.DocObject.toNodeArray(t).forEach((e=>{r.appendChild(e)})),r}}}},391:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DocObject=void 0;const c=o(n(360)),u=s(n(382));class a{constructor(e,t){this.querySelectorAll=e=>this.root.querySelectorAll(e);const{elements:n,values:i,render:r,binds:s,bindAttr:o,bindInAttr:d,isJQuery:l,connections:h,removeOnload:f}=a.defaultParams(t);let b=a.toNodeArray(e)[0];b instanceof HTMLElement?this.root=b:(0,u.default)(u.ROOT_ERROR,!0),this._connections=h,l&&window.jQuery?(this._isJQuery=!0,this._querySelect=(...e)=>$(this.root).find(...e)):(l&&(0,u.default)(u.JQUERY_NOT_DETECTED,!1),this._isJQuery=!1,this._querySelect=(...e)=>this.root.querySelectorAll(...e)),this.root._DocObject=this,this.render=r,this.g=new c.default(this),this.binds="function"==typeof s?s(this.g):s,this.bindAttr=o,this.bindInAttr=d,this.query=new Proxy({},{get:(e,t)=>{if("string"==typeof t)return e[t]?e[t]:e=>this._querySelect(/.*(\.|\#|\[|\]).*/gm.exec(t)?t:"#"+t)},set:(e,t,n,i)=>("string"==typeof n&&(n=()=>this._querySelect(n)),"string"==typeof t&&(e[t]=e=>n),!0)}),this.elements=new Proxy(this.query,{get:(e,t)=>e[t]()}),n&&Object.entries(n).forEach((e=>{this.query[e[0]]=e[1]})),this._values=new Proxy(i&&"object"==typeof i?i:{},{set:(e,t,n,i)=>(this.runRender({[t]:n}),e[t]=n,this.runConnections({[t]:n}),!0)}),this.onLoad=()=>{this.runRender({[!0]:!0}),this.runConnections(this.values)},f||(this._isJQuery?$(this.onLoad):window.onload=this.onLoad)}static toNodeArray(e){return"string"==typeof e||"number"==typeof e?[...a.parser.parseFromString(e.toString(),"text/html").body.childNodes]:NodeList.prototype.isPrototypeOf(e)||window.jQuery&&e instanceof jQuery?[...e]:Array.isArray(e)?e.filter((e=>"string"==typeof e||e instanceof Node)).map((e=>"string"==typeof e?a.toNodeArray(e)[0]:e)):e instanceof Node||e instanceof Document?[e]:void 0}static defaultParams({render:e=[],binds:t={},elements:n={},values:i={},bindAttr:r="d-bind",bindInAttr:s="d-bind-in",isJQuery:o=!1,connections:c=[],removeOnload:u=!1}={}){return{elements:n,values:i,render:e,binds:t,bindAttr:r,bindInAttr:s,isJQuery:o,connections:c,removeOnload:u}}set values(e){throw Error("Tried to set DocObject.value. Try creating a inner object instead.")}get values(){return this._values}isBindIn(e){return e.getAttribute(this.bindInAttr)&&!0}isBind(e){return("d-bind"===e.localName||e.getAttribute(this.bindAttr))&&!0}static isDobObjectElement(e){return e._DocObject instanceof a}findOrRegisterBind(e){if(void 0===e._DocObjectConfig){let t=[...e.childNodes];t.toString=()=>e.innerHTML,e._DocObjectConfig={originalChildren:t,originalChildrenHTML:e.innerHTML,originalAttributes:[...e.attributes].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{})}}return e._DocObjectConfig}generateBind(e,t,n){const i=e._DocObjectConfig,r=a.toNodeArray(n);if(this.isBind(e)){const e=r.find((e=>e instanceof HTMLElement));return e._DocObjectConfig=i,e.setAttribute("d-bind"===e.localName?"to":this.bindAttr,t),Object.entries(i.originalAttributes).filter((e=>!["d-bind-in","to"].includes(e[0]))).forEach((t=>e.setAttribute(t[0],t[1]))),e}return r}runRender(e={}){this.render.filter((t=>t.dep&&Array.isArray(t.dep)&&t.dep.some((t=>t in e))||void 0===t.dep)).forEach((t=>{t.clean&&t.clean(Object.assign(Object.assign({},this.values),e),this.values),t.action(Object.assign(Object.assign({},this.values),e),this.values)})),this.runBinds(this.root,e)}getBindAction(e){if(this.isBind(e)){if(e.getAttribute(this.bindAttr))return[e.getAttribute(this.bindAttr),t=>e.parentNode.replaceChild(t,e)];if("d-bind"===e.localName)return[e.getAttribute("to"),t=>e.parentNode.replaceChild(t,e)]}else if(this.isBindIn(e))return[e.getAttribute(this.bindInAttr),t=>{e.innerHTML="";for(let n of t)e.appendChild(n)}]}runBinds(e,t={}){return(Array.isArray(e)?e:[e]).filter((e=>e&&e instanceof HTMLElement)).forEach((e=>{[...e.querySelectorAll(`[${this.bindAttr}], [${this.bindInAttr}], d-bind[to]`)].forEach((e=>{const[n,i]=this.getBindAction(e);if(n in this.binds){const r=this.findOrRegisterBind(e);i(this.runBinds(this.generateBind(e,n,this.binds[n](Object.assign(Object.assign({},this.values),t),r.originalAttributes,r.originalChildren)),t))}}))})),e}runConnections(e={[!0]:!0}){for(let t in e)this._connections.forEach((n=>n.values[t]=e[t]))}connect(...e){return this._connections=[...this._connections,...e],this.runConnections(this.values),this}}t.DocObject=a,a.parser=new DOMParser},382:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JQUERY_NOT_DETECTED=t.ROOT_ERROR=void 0,t.ROOT_ERROR="ROOT_ERROR",t.JQUERY_NOT_DETECTED="JQUERY_NOT_DETECTED",t.default=function(e,t=!1){if(e in n){if(t)throw Error("DocObject: "+n[e].message);console.error(n[e].message)}};const n={ROOT_ERROR:{message:"Root Element Must be a valid Node, Or jQuery Element"},JQUERY_NOT_DETECTED:{message:"JQuery is not detected. Please load JQuery before DocObject"}}},294:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.gen=t.obj=t.fixInput=void 0;const r=n(391),s=i(n(360)),o=n(605);class c extends HTMLElement{constructor(){super()}}t.fixInput=function(e,t){let n=(0,o.getCursorPos)(e()[0]);t(),(0,o.setCursorPos)(e()[0],n)},window.customElements.define("d-bind",c),window.jQuery&&jQuery.fn.extend({DocObject:function(e=null){return this[0]._DocObject&&!e||(this.each((function(){new r.DocObject(this,e)})),new r.DocObject(this,Object.assign({isJQuery:!0},e))),this[0]._DocObject}}),t.obj=function(e,t){return new r.DocObject(e,t)},t.gen=function(){return new s.default}},605:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setCursorPos=t.getCursorPos=void 0,t.getCursorPos=function(e){return"backward"==e.selectionDirection?e.selectionStart:e.selectionEnd},t.setCursorPos=function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}}},t={},n=function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}(294);Doc=n})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxRQ2xCV0gsQ0FBb0IsSyIsInNvdXJjZXMiOlsid2VicGFjazovL0RvYy8uL3NyYy90cy9kb2NnZW4udHMiLCJ3ZWJwYWNrOi8vRG9jLy4vc3JjL3RzL2RvY29iamVjdC50cyIsIndlYnBhY2s6Ly9Eb2MvLi9zcmMvdHMvZXJyb3JzLnRzIiwid2VicGFjazovL0RvYy8uL3NyYy90cy9pbmRleC50cyIsIndlYnBhY2s6Ly9Eb2MvLi9zcmMvdHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vRG9jL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0RvYy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEb2NPYmplY3QsIERvY09iamVjdEhUTUxMaWtlfSBmcm9tICcuL2RvY29iamVjdCdcclxuaW1wb3J0IHsgRG9jT2JqZWN0QmluZEF0dHJpYnV0ZSB9IGZyb20gJy4vZG9jYmluZCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERvY0dlbiB7XHJcbiAgICBcclxuICAgIG9iaiA/IDogRG9jT2JqZWN0IFxyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihvYmo/IDogRG9jT2JqZWN0KXtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm9iaiA9IG9ialxyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHRoaXMsIHtcclxuICAgICAgICAgICAgZ2V0Oih0YXJnZXQsIHByb3AgKSA9PiB7XHJcbiAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkdlbihwcm9wIGFzIHN0cmluZylcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgR2VuKHByb3AgOiBzdHJpbmcpe1xyXG4gICAgICAgIHJldHVybiAoaW5uZXIgOiBEb2NPYmplY3RIVE1MTGlrZSB8IEFycmF5PHN0cmluZ3xOb2RlPiA9IFtdICwgYXR0cnMgOiBEb2NPYmplY3RCaW5kQXR0cmlidXRlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMub2JqICYmIHByb3AgaW4gdGhpcy5vYmouYmluZHMpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub2JqLmJpbmRzW3Byb3BdKHRoaXMub2JqLnZhbHVlcywgYXR0cnMsIERvY09iamVjdC50b05vZGVBcnJheShpbm5lcikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHByb3ApXHJcbiAgICAgICAgICAgIGZvcihsZXQga2V5IGluIGF0dHJzKXtcclxuICAgICAgICAgICAgICAgIGlmKGtleSA9PT0gJ3N0eWxlJyAmJiB0eXBlb2YgYXR0cnNba2V5XSA9PT0gJ29iamVjdCcgKXtcclxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHNrZXkgaW4gYXR0cnNba2V5IGFzIHN0cmluZ10pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlW3NrZXldID0gYXR0cnNba2V5XVtza2V5XVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihrZXkuc3RhcnRzV2l0aCgnb24nKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudFtrZXldID0gYXR0cnNba2V5XVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyc1trZXldKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIERvY09iamVjdC50b05vZGVBcnJheShpbm5lcikuZm9yRWFjaChpbmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChpbmUpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCB7IERvY09iamVjdERvbUJpbmQsIERvY09iamVjdEJpbmQsIERvY09iamVjdEJpbmRHZW4gfSBmcm9tICcuL2RvY2JpbmQnXHJcbmltcG9ydCB7IERvY09iamVjdFJlbmRlciB9IGZyb20gJy4vZG9jcmVuZGVyJ1xyXG5pbXBvcnQgIERvY0dlbiAgZnJvbSAnLi9kb2NnZW4nXHJcbmltcG9ydCBydW5FcnJvciwgeyBcclxuICAgIFJPT1RfRVJST1IsXHJcbiAgICBKUVVFUllfTk9UX0RFVEVDVEVEXHJcbn0gZnJvbSAnLi9lcnJvcnMnO1xyXG5cclxuLyoqKioqKiogR0xPQkFMUyAqKioqKioqL1xyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcclxuICAgICAgICBqUXVlcnk6YW55O1xyXG4gICAgICAgIG1zQ3J5cHRvOmFueTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qKioqKioqIERPQyBPQkpFQ1QgKioqKioqKi9cclxuZXhwb3J0IHR5cGUgRG9jT2JqZWN0SFRNTExpa2UgPSBcclxufCBOb2RlXHJcbnwgTm9kZUxpc3RcclxufCBKUXVlcnkgXHJcbnwgTnVtYmVyXHJcbnwgc3RyaW5nO1xyXG5cclxuXHJcbmludGVyZmFjZSBEb2NPYmplY3RPcHRpb25zIHtcclxuICAgIHJlbmRlciA6IERvY09iamVjdFJlbmRlcjtcclxuICAgIGJpbmRzIDogRG9jT2JqZWN0QmluZCB8IERvY09iamVjdEJpbmRHZW47XHJcbiAgICBlbGVtZW50cyA6IHtba2V5OnN0cmluZ106IHN0cmluZ307XHJcbiAgICB2YWx1ZXMgOiBvYmplY3Q7XHJcbiAgICBiaW5kQXR0ciA6IHN0cmluZztcclxuICAgIGJpbmRJbkF0dHIgOiBzdHJpbmc7XHJcbiAgICBpc0pRdWVyeSA6IGJvb2xlYW47XHJcbiAgICBjb25uZWN0aW9ucyA6IEFycmF5PERvY09iamVjdD5cclxuICAgIHJlbW92ZU9ubG9hZCA6IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEb2NPYmplY3RFbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xyXG4gICAgX0RvY09iamVjdD8gOiBEb2NPYmplY3RcclxufVxyXG5cclxuaW50ZXJmYWNlIERvY09iamVjdEVsZW1lbnRzIHtcclxuICAgIFtrZXk6IHN0cmluZ10gOiBzdHJpbmcgfCAoKHNlbGVjdG9yIDogc3RyaW5nICkgPT4gTm9kZUxpc3R8SlF1ZXJ5KVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERvY09iamVjdENvbmZpZyB7XHJcbiAgICBvcmlnaW5hbENoaWxkcmVuOiBBcnJheTxOb2RlPjtcclxuICAgIG9yaWdpbmFsQ2hpbGRyZW5IVE1MOiBzdHJpbmc7XHJcbiAgICBvcmlnaW5hbEF0dHJpYnV0ZXM6IHtba2V5OnN0cmluZ10gOiBzdHJpbmd9O1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIERvY09iamVjdCB7XHJcblxyXG4gICAgc3RhdGljIHBhcnNlciA6IERPTVBhcnNlciA9IG5ldyBET01QYXJzZXIoKVxyXG5cclxuICAgIHN0YXRpYyB0b05vZGVBcnJheShhbnkgOiBEb2NPYmplY3RIVE1MTGlrZSB8IEFycmF5PHN0cmluZ3xOb2RlPiApIDogQXJyYXk8Tm9kZT4ge1xyXG4gICAgICAgIGlmKHR5cGVvZiBhbnkgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhbnkgPT09ICdudW1iZXInKXtcclxuICAgICAgICAgICAgcmV0dXJuIFsuLi5Eb2NPYmplY3QucGFyc2VyLnBhcnNlRnJvbVN0cmluZyhhbnkudG9TdHJpbmcoKSwgJ3RleHQvaHRtbCcpLmJvZHkuY2hpbGROb2Rlc11cclxuICAgICAgICB9ZWxzZSBpZihOb2RlTGlzdC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihhbnkpIHx8ICh3aW5kb3cualF1ZXJ5ICYmIGFueSBpbnN0YW5jZW9mIGpRdWVyeSkpe1xyXG4gICAgICAgICAgICByZXR1cm4gWyAuLi4oYW55IGFzIE5vZGVMaXN0KV1cclxuICAgICAgICB9ZWxzZSBpZihBcnJheS5pc0FycmF5KGFueSkpe1xyXG4gICAgICAgICAgICByZXR1cm4gYW55XHJcbiAgICAgICAgICAgIC5maWx0ZXIoZT0+ICh0eXBlb2YgZSA9PT0gJ3N0cmluZycpIHx8IGUgaW5zdGFuY2VvZiBOb2RlIClcclxuICAgICAgICAgICAgLm1hcChlPT4gKHR5cGVvZiBlID09PSAnc3RyaW5nJykgPyBEb2NPYmplY3QudG9Ob2RlQXJyYXkoZSlbMF0gOiBlICk7XHJcbiAgICAgICAgfSBlbHNlIGlmKGFueSBpbnN0YW5jZW9mIE5vZGUgfHwgYW55IGluc3RhbmNlb2YgRG9jdW1lbnQgKXtcclxuICAgICAgICAgICAgcmV0dXJuIFthbnldXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBkZWZhdWx0UGFyYW1zKHtcclxuICAgICAgICByZW5kZXIgPSBbXSxcclxuICAgICAgICBiaW5kcyA9IHt9LFxyXG4gICAgICAgIGVsZW1lbnRzID0ge30sXHJcbiAgICAgICAgdmFsdWVzID0ge30sXHJcbiAgICAgICAgYmluZEF0dHIgPSAnZC1iaW5kJyxcclxuICAgICAgICBiaW5kSW5BdHRyID0gJ2QtYmluZC1pbicsXHJcbiAgICAgICAgaXNKUXVlcnkgPSBmYWxzZSxcclxuICAgICAgICBjb25uZWN0aW9ucyA9IFtdLFxyXG4gICAgICAgIHJlbW92ZU9ubG9hZCA9IGZhbHNlXHJcbiAgICB9ID0ge30pIDogRG9jT2JqZWN0T3B0aW9ucyB7XHJcbiAgICAgICAgcmV0dXJuICB7IGVsZW1lbnRzLCB2YWx1ZXMsIHJlbmRlciwgYmluZHMsIGJpbmRBdHRyLCBiaW5kSW5BdHRyLCBpc0pRdWVyeSwgY29ubmVjdGlvbnMsIHJlbW92ZU9ubG9hZCB9IFxyXG4gICAgfVxyXG5cclxuXHJcblxyXG5cclxuICAgIHJlYWRvbmx5IF92YWx1ZXMgOiBvYmplY3Q7XHJcbiAgICBlbGVtZW50cyA6IFByb3h5SGFuZGxlcjxEb2NPYmplY3RFbGVtZW50cz47XHJcbiAgICByb290IDogRG9jT2JqZWN0RWxlbWVudDtcclxuICAgIHJlbmRlciA6IERvY09iamVjdFJlbmRlcjtcclxuICAgIGJpbmRzIDogRG9jT2JqZWN0QmluZDtcclxuICAgIGJpbmRBdHRyIDogc3RyaW5nO1xyXG4gICAgYmluZEluQXR0ciA6IHN0cmluZztcclxuICAgIHF1ZXJ5IDogUHJveHlIYW5kbGVyPERvY09iamVjdEVsZW1lbnRzPjtcclxuICAgIF9xdWVyeVNlbGVjdCA6IChzZWxlY3RvcjpzdHJpbmcpPT4gTm9kZUxpc3QgfCBKUXVlcnk7XHJcbiAgICBfaXNKUXVlcnkgOiBib29sZWFuXHJcbiAgICBfY29ubmVjdGlvbnMgOiBBcnJheTxEb2NPYmplY3Q+XHJcbiAgICBnIDogRG9jR2VuXHJcbiAgICBvbkxvYWQ6ICgpPT52b2lkXHJcblxyXG4gICAgc2V0IHZhbHVlcyh2YWx1ZXMpIHtcclxuICAgICAgICB0aHJvdyBFcnJvcihcIlRyaWVkIHRvIHNldCBEb2NPYmplY3QudmFsdWUuIFRyeSBjcmVhdGluZyBhIGlubmVyIG9iamVjdCBpbnN0ZWFkLlwiKVxyXG4gICAgfVxyXG4gICAgZ2V0IHZhbHVlcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWVzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKHJvb3QgOiBEb2NPYmplY3RFbGVtZW50IHwgSlF1ZXJ5LCBvcHRpb25zIDogb2JqZWN0KSB7XHJcbiAgICAgICAgLy9BZGQgRGVmYXVsdCBQYXJhbWV0ZXJzIHRvIG9wdGlvbnNcclxuICAgICAgICBjb25zdCB7IGVsZW1lbnRzLCB2YWx1ZXMsIHJlbmRlciwgYmluZHMsIGJpbmRBdHRyLCBiaW5kSW5BdHRyLCBpc0pRdWVyeSwgY29ubmVjdGlvbnMsIHJlbW92ZU9ubG9hZCB9IDogRG9jT2JqZWN0T3B0aW9ucyA9IERvY09iamVjdC5kZWZhdWx0UGFyYW1zKG9wdGlvbnMpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9FeHRyYWN0IERPTSBlbGVtZW50IGZyb20gSFRNTEVsZW1lbnQgT3IgSnF1ZXJ5IE9iamVjdFxyXG4gICAgICAgIGxldCByb290RWxlbWVudCA9IERvY09iamVjdC50b05vZGVBcnJheShyb290KVswXVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vU2V0IFJvb3QgT2JqZWN0XHJcbiAgICAgICAgaWYocm9vdEVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCApe1xyXG4gICAgICAgICAgICB0aGlzLnJvb3QgPSByb290RWxlbWVudFxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBydW5FcnJvcihST09UX0VSUk9SLCB0cnVlKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fY29ubmVjdGlvbnMgPSBjb25uZWN0aW9ucztcclxuXHJcbiAgICAgICAgLy9TZXQgSnF1ZXJ5XHJcbiAgICAgICAgaWYoaXNKUXVlcnkgJiYgd2luZG93LmpRdWVyeSl7XHJcbiAgICAgICAgICAgIC8vSWYgSnF1ZXJ5IGlzIGRldGVjdGVkIGFuZCBpcyBzZXQgdG8ganF1ZXJ5IG1vZGUuLi5cclxuICAgICAgICAgICAgdGhpcy5faXNKUXVlcnkgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgLy9TZXQgUXVlcnkgU2VsZWN0IHN0YXRlbWVudCB0byB1c2UgalF1ZXJ5XHJcbiAgICAgICAgICAgIHRoaXMuX3F1ZXJ5U2VsZWN0ID0gKC4uLnByb3BzKSA9PiAkKHRoaXMucm9vdCkuZmluZCguLi5wcm9wcylcclxuICAgICAgICB9ZWxzZSB7XHJcbiAgICAgICAgICAgIC8vSWYgSnF1ZXJ5IGlzIG5vdCBkZXRlY3RlZC4uLlxyXG4gICAgICAgICAgICBpZihpc0pRdWVyeSl7XHJcbiAgICAgICAgICAgICAgICAvL0lmIHNldCB0byBqcXVlcnkgbW9kZS4uLlxyXG4gICAgICAgICAgICAgICAgcnVuRXJyb3IoSlFVRVJZX05PVF9ERVRFQ1RFRCwgZmFsc2UpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy9TZXQgUXVlcnkgU2VsZWN0IHN0YXRlbWVudCB0byB1c2UgSFRNTEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbFxyXG4gICAgICAgICAgICB0aGlzLl9pc0pRdWVyeSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9xdWVyeVNlbGVjdCA9ICguLi5wcm9wcykgPT4gdGhpcy5yb290LnF1ZXJ5U2VsZWN0b3JBbGwoLi4ucHJvcHMpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL1NldCBSb290IE9iamVjdCB0byB0aGlzXHJcbiAgICAgICAgdGhpcy5yb290Ll9Eb2NPYmplY3QgPSB0aGlzO1xyXG5cclxuICAgICAgICAvL1NldCBSZW5kZXIgRnVuY3Rpb25zXHJcbiAgICAgICAgdGhpcy5yZW5kZXIgPSByZW5kZXI7XHJcblxyXG4gICAgICAgIC8vQ3JlYXRlIFJlbGF0ZWQgRG9jR2VuXHJcbiAgICAgICAgdGhpcy5nID0gbmV3IERvY0dlbih0aGlzKVxyXG5cclxuICAgICAgICAvL1NldCBCaW5kIEZ1bmN0aW9uc1xyXG4gICAgICAgIHRoaXMuYmluZHMgPSAodHlwZW9mIGJpbmRzID09PSAnZnVuY3Rpb24nKSA/IGJpbmRzKHRoaXMuZykgOiBiaW5kcyA7XHJcblxyXG4gICAgICAgIC8vU2V0IEJpbmQgQXR0cmlidXRlXHJcbiAgICAgICAgdGhpcy5iaW5kQXR0ciA9IGJpbmRBdHRyO1xyXG5cclxuICAgICAgICAvL1NldCBCaW5kIEluIEF0dHJpYnV0ZVxyXG4gICAgICAgIHRoaXMuYmluZEluQXR0ciA9IGJpbmRJbkF0dHI7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9TZXQgUXVlcnkgUHJveHlcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gbmV3IFByb3h5KHt9LCB7XHJcbiAgICAgICAgICAgIGdldDogKHRhcmdldCwgcHJvcCApID0+IHtcclxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBwcm9wID09ICdzdHJpbmcnKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAgdGFyZ2V0W3Byb3BdID8gdGFyZ2V0W3Byb3BdIDogXyA9PiB0aGlzLl9xdWVyeVNlbGVjdCggLy4qKFxcLnxcXCN8XFxbfFxcXSkuKi9nbS5leGVjKHByb3ApID8gcHJvcCA6ICcjJyArIHByb3AgKSBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0OiAodGFyZ2V0LCBwcm9wLCB2YWx1ZSwgcmVjZWl2ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB2YWx1ZSA9ICgpID0+IHRoaXMuX3F1ZXJ5U2VsZWN0KHZhbHVlKVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBwcm9wID09PSAnc3RyaW5nJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gXyA9PiB2YWx1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgLy9TZXQgRWxlbWVudHMgUHJveHlcclxuICAgICAgICB0aGlzLmVsZW1lbnRzID0gbmV3IFByb3h5KHRoaXMucXVlcnksIHtcclxuICAgICAgICAgICAgZ2V0OiAodGFyZ2V0LCBwcm9wKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0W3Byb3BdKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vQWRkIGluIGVsZW1lbnRzIGZyb20gb3B0aW9uc1xyXG4gICAgICAgIGlmIChlbGVtZW50cykge1xyXG4gICAgICAgICAgICBPYmplY3QuZW50cmllcyhlbGVtZW50cykuZm9yRWFjaCgoZSA9PiB7IHRoaXMucXVlcnlbZVswXV0gPSBlWzFdIH0pKVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIHRoaXMuX3ZhbHVlcyA9IG5ldyBQcm94eSghdmFsdWVzIHx8IHR5cGVvZiB2YWx1ZXMgIT09ICdvYmplY3QnID8ge30gOiB2YWx1ZXMsIHtcclxuICAgICAgICAgICAgc2V0OiAodGFyZ2V0LCBwcm9wLCB2YWx1ZSwgcmVjZWl2ZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMucnVuUmVuZGVyKHsgW3Byb3BdOiB2YWx1ZSB9KVxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0W3Byb3BdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJ1bkNvbm5lY3Rpb25zKHtbcHJvcF06dmFsdWV9KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgIFxyXG4gICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5vbkxvYWQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucnVuUmVuZGVyKHsgW3RydWUgYXMgYW55XTogdHJ1ZSB9KVxyXG4gICAgICAgICAgICB0aGlzLnJ1bkNvbm5lY3Rpb25zKHRoaXMudmFsdWVzKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIXJlbW92ZU9ubG9hZCl7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuX2lzSlF1ZXJ5KXtcclxuICAgICAgICAgICAgICAgICQodGhpcy5vbkxvYWQpXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgd2luZG93Lm9ubG9hZCA9IHRoaXMub25Mb2FkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGlzQmluZEluKGVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoIGVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEluQXR0cikgJiYgdHJ1ZSApIFxyXG4gICAgfVxyXG4gICAgaXNCaW5kKGVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoZWxlbWVudC5sb2NhbE5hbWUgPT09ICdkLWJpbmQnIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEF0dHIpKSAmJiB0cnVlXHJcbiAgICB9XHJcbiAgICBzdGF0aWMgaXNEb2JPYmplY3RFbGVtZW50KGVsZW1lbnQgOiBEb2NPYmplY3RFbGVtZW50ICkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKCBlbGVtZW50Ll9Eb2NPYmplY3QgaW5zdGFuY2VvZiBEb2NPYmplY3QgIClcclxuICAgIH1cclxuXHJcblxyXG4gICAgZmluZE9yUmVnaXN0ZXJCaW5kKERPTWVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kKSA6IERvY09iamVjdENvbmZpZyB7XHJcbiAgICAgICAgaWYoRE9NZWxlbWVudC5fRG9jT2JqZWN0Q29uZmlnID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBsZXQgb3JpZ2luYWxDaGlsZHJlbiA9IFsuLi5ET01lbGVtZW50LmNoaWxkTm9kZXNdXHJcbiAgICAgICAgICAgIG9yaWdpbmFsQ2hpbGRyZW4udG9TdHJpbmcgPSAoKT0+IERPTWVsZW1lbnQuaW5uZXJIVE1MXHJcbiAgICAgICAgICAgIERPTWVsZW1lbnQuX0RvY09iamVjdENvbmZpZyA9IHtcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsQ2hpbGRyZW4sXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbENoaWxkcmVuSFRNTDogRE9NZWxlbWVudC5pbm5lckhUTUwsXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEF0dHJpYnV0ZXM6IFsuLi5ET01lbGVtZW50LmF0dHJpYnV0ZXNdLnJlZHVjZSggKGEsYyk9PntyZXR1cm4gey4uLmEsIFtjLm5hbWVdOmMudmFsdWV9IH0sIHt9IClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gRE9NZWxlbWVudC5fRG9jT2JqZWN0Q29uZmlnXHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhdGVCaW5kKGVsZW1lbnQgOiBEb2NPYmplY3REb21CaW5kLCBiaW5kLCBib3VuZCA6IERvY09iamVjdEhUTUxMaWtlICkgOiBEb2NPYmplY3REb21CaW5kIHwgTm9kZVtdIHtcclxuICAgICAgICBjb25zdCBjb25maWcgPSBlbGVtZW50Ll9Eb2NPYmplY3RDb25maWc7XHJcbiAgICAgICAgY29uc3Qgbm9kZUFycmF5ID0gRG9jT2JqZWN0LnRvTm9kZUFycmF5KGJvdW5kKTtcclxuICAgICAgICBpZih0aGlzLmlzQmluZChlbGVtZW50KSl7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0RWxlbWVudCA9IG5vZGVBcnJheS5maW5kKGVsID0+IGVsIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIGFzIERvY09iamVjdERvbUJpbmQ7XHJcbiAgICAgICAgICAgIGZpcnN0RWxlbWVudC5fRG9jT2JqZWN0Q29uZmlnID0gY29uZmlnO1xyXG4gICAgICAgICAgICBmaXJzdEVsZW1lbnQuc2V0QXR0cmlidXRlKChmaXJzdEVsZW1lbnQubG9jYWxOYW1lID09PSAnZC1iaW5kJyA/ICd0bycgOiB0aGlzLmJpbmRBdHRyKSwgYmluZClcclxuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoY29uZmlnLm9yaWdpbmFsQXR0cmlidXRlcykuZmlsdGVyKGF0dEE9PiEoWydkLWJpbmQtaW4nLCAndG8nXS5pbmNsdWRlcyhhdHRBWzBdKSkpLmZvckVhY2goYXR0QT0+Zmlyc3RFbGVtZW50LnNldEF0dHJpYnV0ZShhdHRBWzBdLCBhdHRBWzFdKSlcclxuICAgICAgICAgICAgcmV0dXJuIGZpcnN0RWxlbWVudDtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIG5vZGVBcnJheTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcblxyXG4gICAgcnVuUmVuZGVyKHZhbHVlQ2hhbmdlcyA9IHt9KSA6IHZvaWQge1xyXG4gICAgICAgIHRoaXMucmVuZGVyLmZpbHRlcihyZW4gPT4gKHJlbi5kZXAgJiYgQXJyYXkuaXNBcnJheShyZW4uZGVwKSAmJiByZW4uZGVwLnNvbWUoKGRlcHApID0+IChkZXBwIGluIHZhbHVlQ2hhbmdlcykpKSB8fCAocmVuLmRlcCA9PT0gdW5kZWZpbmVkKSkuZm9yRWFjaChyZW4gPT4ge1xyXG4gICAgICAgICAgICBpZiAocmVuLmNsZWFuKSByZW4uY2xlYW4oeyAuLi50aGlzLnZhbHVlcywgLi4udmFsdWVDaGFuZ2VzIH0sIHRoaXMudmFsdWVzKVxyXG4gICAgICAgICAgICByZW4uYWN0aW9uKHsgLi4udGhpcy52YWx1ZXMsIC4uLnZhbHVlQ2hhbmdlcyB9LCB0aGlzLnZhbHVlcylcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMucnVuQmluZHModGhpcy5yb290LCB2YWx1ZUNoYW5nZXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEJpbmRBY3Rpb24oZWxlbWVudCA6IEhUTUxFbGVtZW50KSA6IFtzdHJpbmcsIChyZXBsYWNlIDogTm9kZSAmIE5vZGVMaXN0ICk9PnZvaWRdIHtcclxuICAgICAgICBpZih0aGlzLmlzQmluZChlbGVtZW50KSl7XHJcbiAgICAgICAgICAgIGlmKGVsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEF0dHIpKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbZWxlbWVudC5nZXRBdHRyaWJ1dGUodGhpcy5iaW5kQXR0ciksIChyZXBsYWNlKT0+ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChyZXBsYWNlLCBlbGVtZW50KV1cclxuICAgICAgICAgICAgfWVsc2UgaWYoZWxlbWVudC5sb2NhbE5hbWUgPT09ICdkLWJpbmQnKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3RvJyksIChyZXBsYWNlKT0+ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChyZXBsYWNlLCBlbGVtZW50KV1cclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9ZWxzZSBpZih0aGlzLmlzQmluZEluKGVsZW1lbnQpKXtcclxuICAgICAgICAgICAgcmV0dXJuIFtlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLmJpbmRJbkF0dHIpLCAocmVwbGFjZSk9PntcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBub2RlIG9mIHJlcGxhY2UpIGVsZW1lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XHJcbiAgICAgICAgICAgIH1dXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcXVlcnlTZWxlY3RvckFsbCA9IChzZWxlY3RvciA6IHN0cmluZykgPT4gdGhpcy5yb290LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpXHJcbiAgICBydW5CaW5kcyhyb290LCB2YWx1ZUNoYW5nZXMgPSB7fSkge1xyXG4gICAgICAgIChBcnJheS5pc0FycmF5KHJvb3QpID8gcm9vdCA6IFtyb290XSkgXHJcbiAgICAgICAgLmZpbHRlcihydD0+cnQgJiYgcnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudClcclxuICAgICAgICAuZm9yRWFjaCgocnQpPT57XHJcbiAgICAgICAgICAgIFsgLi4uKHJ0LnF1ZXJ5U2VsZWN0b3JBbGwoYFske3RoaXMuYmluZEF0dHJ9XSwgWyR7dGhpcy5iaW5kSW5BdHRyfV0sIGQtYmluZFt0b11gKSkgXSBcclxuICAgICAgICAgICAgLmZvckVhY2goIGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy9HZXQgVGhlIEJpbmQgTWV0aG9kLCBhbmQgdGhlIEZ1bmN0aW9uIHRvIGluc2VydCBIVE1MIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgW2JpbmQsIGJpbmRBY3Rpb25dID0gdGhpcy5nZXRCaW5kQWN0aW9uKGVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICAvL0NoZWNrIGlmIEJpbmQgRXhpc3RzIFxyXG4gICAgICAgICAgICAgICAgaWYgKGJpbmQgaW4gdGhpcy5iaW5kcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0dldCBPciByZWdpc3RlciBCaW5kIFRhZydzIENvbmZpZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSB0aGlzLmZpbmRPclJlZ2lzdGVyQmluZChlbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9JbnNlcnQgSFRNTFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiaW5kQWN0aW9uKHRoaXMucnVuQmluZHMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vV3JhcCBCaW5kIE1ldGhvZCB0byBwcmVwYXJlIGJpbmQgZm9yIGRvY3VtZW50XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlQmluZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW5kLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1J1biBCaW5kIE1ldGhvZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZHNbYmluZF0oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgLi4udGhpcy52YWx1ZXMsIC4uLnZhbHVlQ2hhbmdlcyB9LCAvL1Bhc3MgaW4gdXBkYXRlcyB2YWx1ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9yaWdpbmFsQXR0cmlidXRlcywgLy9QYXNzIGluIG9yaWdpbmFsIGF0dHJpYnV0ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnLm9yaWdpbmFsQ2hpbGRyZW4sIC8vUGFzcyBpbiBvcmlnaW5hbCBjaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiByb290O1xyXG4gICAgfVxyXG5cclxuICAgIHJ1bkNvbm5lY3Rpb25zKHZhbHVlQ2hhbmdlcyA6IHtba2V5IDogc3RyaW5nfHN5bWJvbF0gOiBhbnkgfSA9IHtbdHJ1ZSBhcyBhbnldOnRydWV9ICl7XHJcbiAgICAgICAgZm9yKGxldCBreSBpbiB2YWx1ZUNoYW5nZXMpe1xyXG4gICAgICAgICAgICB0aGlzLl9jb25uZWN0aW9ucy5mb3JFYWNoKChjb25uZWN0ZWQpID0+IGNvbm5lY3RlZC52YWx1ZXNba3ldID0gdmFsdWVDaGFuZ2VzW2t5XSlcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNvbm5lY3QoLi4uZG9jT2JqZWN0cyA6IFtEb2NPYmplY3RdKXtcclxuICAgICAgICB0aGlzLl9jb25uZWN0aW9ucyA9IFsuLi50aGlzLl9jb25uZWN0aW9ucywgLi4uZG9jT2JqZWN0c11cclxuICAgICAgICB0aGlzLnJ1bkNvbm5lY3Rpb25zKHRoaXMudmFsdWVzKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG4vKlxyXG52YXIgZG9jID0gbmV3IERvY09iamVjdCh7XHJcbiAgICB2YWx1ZXM6IHtcclxuICAgIH0sXHJcbiAgICBlbGVtZW50czp7XHJcblxyXG4gICAgfSxcclxuICAgIGJpbmRzOntcclxuXHJcbiAgICB9LFxyXG4gICAgcmVuZGVyOiBbXHJcblxyXG4gICAgXVxyXG59KTsgJChkb2Mub25Mb2FkKVxyXG4qLyIsIlxyXG5cclxuZXhwb3J0IGNvbnN0IFJPT1RfRVJST1IgPSAnUk9PVF9FUlJPUidcclxuZXhwb3J0IGNvbnN0IEpRVUVSWV9OT1RfREVURUNURUQgPSAnSlFVRVJZX05PVF9ERVRFQ1RFRCdcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBydW5FcnJvcihlcnJvciA6IHN0cmluZywgZmFpbD1mYWxzZSl7XHJcbiAgICBpZihlcnJvciBpbiBFUlJPUlMpe1xyXG4gICAgICAgIGlmKGZhaWwpe1xyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignRG9jT2JqZWN0OiAnKyBFUlJPUlNbZXJyb3JdLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKEVSUk9SU1tlcnJvcl0ubWVzc2FnZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmNvbnN0IEVSUk9SUyA9IHtcclxuICAgIFJPT1RfRVJST1IgOiB7XHJcbiAgICAgICAgbWVzc2FnZTogXCJSb290IEVsZW1lbnQgTXVzdCBiZSBhIHZhbGlkIE5vZGUsIE9yIGpRdWVyeSBFbGVtZW50XCJcclxuICAgIH0sXHJcbiAgICBKUVVFUllfTk9UX0RFVEVDVEVEOiB7XHJcbiAgICAgICAgbWVzc2FnZSA6IFwiSlF1ZXJ5IGlzIG5vdCBkZXRlY3RlZC4gUGxlYXNlIGxvYWQgSlF1ZXJ5IGJlZm9yZSBEb2NPYmplY3RcIlxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IERvY09iamVjdCwgRG9jT2JqZWN0RWxlbWVudCB9IGZyb20gXCIuL2RvY29iamVjdFwiO1xyXG5pbXBvcnQgRG9jR2VuIGZyb20gXCIuL2RvY2dlblwiO1xyXG5pbXBvcnQge3NldEN1cnNvclBvcywgZ2V0Q3Vyc29yUG9zfSBmcm9tIFwiLi91dGlsc1wiXHJcblxyXG5jbGFzcyBCaW5kIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKVxyXG4gICAgfVxyXG59XHJcblxyXG4vKioqKioqKiBVVElMSVRZIE1FVEhPRFMgKioqKioqKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGZpeElucHV0KHNlbGVjdG9yLCBhY3Rpb24pe1xyXG4gICAgbGV0IHBvcyA9IGdldEN1cnNvclBvcyhzZWxlY3RvcigpWzBdKVxyXG4gICAgYWN0aW9uKClcclxuICAgIHNldEN1cnNvclBvcyhzZWxlY3RvcigpWzBdLCBwb3MpXHJcbn1cclxuXHJcblxyXG53aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCdkLWJpbmQnLCBCaW5kKVxyXG5pZih3aW5kb3cualF1ZXJ5KXtcclxuICAgIChmdW5jdGlvbigkKSB7XHJcbiAgICAgICAgJC5mbi5leHRlbmQoe1xyXG4gICAgICAgICAgICBEb2NPYmplY3QgOiBmdW5jdGlvbiggb3B0aW9ucyA9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXNbMF0uX0RvY09iamVjdCAmJiAhb3B0aW9ucyApIHJldHVybiB0aGlzWzBdLl9Eb2NPYmplY3Q7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IERvY09iamVjdCh0aGlzLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgbmV3IERvY09iamVjdCh0aGlzLCB7IGlzSlF1ZXJ5OnRydWUsIC4uLm9wdGlvbnMgfSlcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzWzBdLl9Eb2NPYmplY3Q7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSkoalF1ZXJ5KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9iaihyb290IDogRG9jT2JqZWN0RWxlbWVudCB8IEpRdWVyeSwgb3B0aW9ucyA6IG9iamVjdCkgOiBEb2NPYmplY3R7XHJcbiAgICByZXR1cm4gbmV3IERvY09iamVjdChyb290LCBvcHRpb25zKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuKCkgOiBEb2NHZW4ge1xyXG4gICAgcmV0dXJuIG5ldyBEb2NHZW4oKVxyXG59XHJcbiIsImludGVyZmFjZSBEb2N1bWVudCB7XHJcbiAgICBzZWxlY3Rpb246IHtcclxuICAgICAgICBcclxuICAgIH1cclxufVxyXG5cclxuLy8gQ3JlZGl0czogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjg5NzE1NS9nZXQtY3Vyc29yLXBvc2l0aW9uLWluLWNoYXJhY3RlcnMtd2l0aGluLWEtdGV4dC1pbnB1dC1maWVsZFxyXG4gZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnNvclBvcyhlbGVtZW50IDogSFRNTElucHV0RWxlbWVudCkgOiBudW1iZXIge1xyXG4gICAgLy8gaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xyXG4gICAgLy8gICAgIGVsZW1lbnQuZm9jdXMoKTtcclxuICAgIC8vICAgICByZXR1cm4gIGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLm1vdmVTdGFydCgnY2hhcmFjdGVyJywgLWVsZW1lbnQudmFsdWUubGVuZ3RoKTtcclxuICAgIC8vIH1cclxuICAgICAgICByZXR1cm4gZWxlbWVudC5zZWxlY3Rpb25EaXJlY3Rpb24gPT0gJ2JhY2t3YXJkJyA/IGVsZW1lbnQuc2VsZWN0aW9uU3RhcnQgOiBlbGVtZW50LnNlbGVjdGlvbkVuZDtcclxufVxyXG5cclxuLy8gQ3JlZGl0czogaHR0cDovL2Jsb2cudmlzaGFsb24ubmV0L2luZGV4LnBocC9qYXZhc2NyaXB0LWdldHRpbmctYW5kLXNldHRpbmctY2FyZXQtcG9zaXRpb24taW4tdGV4dGFyZWEvXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRDdXJzb3JQb3MoZWxlbWVudCA6IEhUTUxJbnB1dEVsZW1lbnQsIHBvcyA6IG51bWJlcikgOiB2b2lkIHtcclxuICAgIC8vIE1vZGVybiBicm93c2Vyc1xyXG4gICAgaWYgKGVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UpIHtcclxuICAgIGVsZW1lbnQuZm9jdXMoKTtcclxuICAgIGVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2UocG9zLCBwb3MpO1xyXG4gICAgXHJcbiAgICAvLyBJRTggYW5kIGJlbG93XHJcbiAgICB9IGVsc2UgaWYgKChlbGVtZW50IGFzIGFueSkuY3JlYXRlVGV4dFJhbmdlKSB7XHJcbiAgICAgIHZhciByYW5nZSA9IChlbGVtZW50IGFzIGFueSkuY3JlYXRlVGV4dFJhbmdlKCk7XHJcbiAgICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpO1xyXG4gICAgICByYW5nZS5tb3ZlRW5kKCdjaGFyYWN0ZXInLCBwb3MpO1xyXG4gICAgICByYW5nZS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIHBvcyk7XHJcbiAgICAgIHJhbmdlLnNlbGVjdCgpO1xyXG4gICAgfVxyXG59IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOTQpO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwib2JqIiwidGhpcyIsIlByb3h5IiwiZ2V0IiwidGFyZ2V0IiwicHJvcCIsIkdlbiIsImlubmVyIiwiYXR0cnMiLCJiaW5kcyIsInZhbHVlcyIsIkRvY09iamVjdCIsInRvTm9kZUFycmF5IiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImtleSIsInNrZXkiLCJzdHlsZSIsInN0YXJ0c1dpdGgiLCJzZXRBdHRyaWJ1dGUiLCJmb3JFYWNoIiwiaW5lIiwiYXBwZW5kQ2hpbGQiLCJyb290Iiwib3B0aW9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzZWxlY3RvciIsImVsZW1lbnRzIiwicmVuZGVyIiwiYmluZEF0dHIiLCJiaW5kSW5BdHRyIiwiaXNKUXVlcnkiLCJjb25uZWN0aW9ucyIsInJlbW92ZU9ubG9hZCIsImRlZmF1bHRQYXJhbXMiLCJyb290RWxlbWVudCIsIkhUTUxFbGVtZW50IiwiUk9PVF9FUlJPUiIsIl9jb25uZWN0aW9ucyIsIndpbmRvdyIsImpRdWVyeSIsIl9pc0pRdWVyeSIsIl9xdWVyeVNlbGVjdCIsInByb3BzIiwiJCIsImZpbmQiLCJKUVVFUllfTk9UX0RFVEVDVEVEIiwiX0RvY09iamVjdCIsImciLCJxdWVyeSIsIl8iLCJleGVjIiwic2V0IiwidmFsdWUiLCJyZWNlaXZlciIsIk9iamVjdCIsImVudHJpZXMiLCJlIiwiX3ZhbHVlcyIsInJ1blJlbmRlciIsInJ1bkNvbm5lY3Rpb25zIiwib25Mb2FkIiwib25sb2FkIiwic3RhdGljIiwiYW55IiwicGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwidG9TdHJpbmciLCJib2R5IiwiY2hpbGROb2RlcyIsIk5vZGVMaXN0IiwicHJvdG90eXBlIiwiaXNQcm90b3R5cGVPZiIsIkFycmF5IiwiaXNBcnJheSIsImZpbHRlciIsIk5vZGUiLCJtYXAiLCJEb2N1bWVudCIsIkVycm9yIiwiaXNCaW5kSW4iLCJnZXRBdHRyaWJ1dGUiLCJpc0JpbmQiLCJsb2NhbE5hbWUiLCJmaW5kT3JSZWdpc3RlckJpbmQiLCJET01lbGVtZW50IiwidW5kZWZpbmVkIiwiX0RvY09iamVjdENvbmZpZyIsIm9yaWdpbmFsQ2hpbGRyZW4iLCJpbm5lckhUTUwiLCJvcmlnaW5hbENoaWxkcmVuSFRNTCIsIm9yaWdpbmFsQXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJyZWR1Y2UiLCJhIiwiYyIsIm5hbWUiLCJnZW5lcmF0ZUJpbmQiLCJiaW5kIiwiYm91bmQiLCJjb25maWciLCJub2RlQXJyYXkiLCJmaXJzdEVsZW1lbnQiLCJlbCIsImF0dEEiLCJpbmNsdWRlcyIsInZhbHVlQ2hhbmdlcyIsInJlbiIsImRlcCIsInNvbWUiLCJkZXBwIiwiY2xlYW4iLCJhY3Rpb24iLCJydW5CaW5kcyIsImdldEJpbmRBY3Rpb24iLCJyZXBsYWNlIiwicGFyZW50Tm9kZSIsInJlcGxhY2VDaGlsZCIsIm5vZGUiLCJydCIsImJpbmRBY3Rpb24iLCJreSIsImNvbm5lY3RlZCIsImNvbm5lY3QiLCJkb2NPYmplY3RzIiwiRE9NUGFyc2VyIiwiZXJyb3IiLCJmYWlsIiwiRVJST1JTIiwibWVzc2FnZSIsImNvbnNvbGUiLCJCaW5kIiwic3VwZXIiLCJwb3MiLCJnZXRDdXJzb3JQb3MiLCJzZXRDdXJzb3JQb3MiLCJjdXN0b21FbGVtZW50cyIsImRlZmluZSIsImZuIiwiZXh0ZW5kIiwiZWFjaCIsInNlbGVjdGlvbkRpcmVjdGlvbiIsInNlbGVjdGlvblN0YXJ0Iiwic2VsZWN0aW9uRW5kIiwic2V0U2VsZWN0aW9uUmFuZ2UiLCJmb2N1cyIsImNyZWF0ZVRleHRSYW5nZSIsInJhbmdlIiwiY29sbGFwc2UiLCJtb3ZlRW5kIiwibW92ZVN0YXJ0Iiwic2VsZWN0IiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCJdLCJzb3VyY2VSb290IjoiIn0=