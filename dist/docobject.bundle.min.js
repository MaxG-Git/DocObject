var Doc;(()=>{"use strict";var e={360:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(391);t.default=class{constructor(e){return this.obj=e,new Proxy(this,{get:(e,t)=>this.Gen(t)})}Gen(e){return(t=[],n)=>{if(this.obj&&e in this.obj.binds){const r=this.obj.binds[e](this.obj.values,n,i.DocObject.toNodeArray(t));return"function"==typeof r?r(this.obj.g):r}let r=document.createElement(e);for(let e in n)if("style"===e&&"object"==typeof n[e])for(let t in n[e])r.style[t]=n[e][t];else e.startsWith("on")?r[e]=n[e]:r.setAttribute(e,n[e]);return i.DocObject.toNodeArray(t).forEach((e=>{r.appendChild(e)})),r}}}},391:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DocObject=void 0;const c=o(n(360)),u=s(n(382));class a{constructor(e,t){this.querySelectorAll=e=>this.root.querySelectorAll(e);const{elements:n,values:i,render:r,binds:s,bindAttr:o,bindInAttr:d,isJQuery:l,connections:f,removeOnload:h}=a.defaultParams(t);let b=a.toNodeArray(e)[0];b instanceof HTMLElement?this.root=b:(0,u.default)(u.ROOT_ERROR,!0),this._connections=f,l&&window.jQuery?(this._isJQuery=!0,this._querySelect=(...e)=>$(this.root).find(...e)):(l&&(0,u.default)(u.JQUERY_NOT_DETECTED,!1),this._isJQuery=!1,this._querySelect=(...e)=>this.root.querySelectorAll(...e)),this.root._DocObject=this,this.render=r,this.g=new c.default(this),this.binds="function"==typeof s?s(this.g):s,this.bindAttr=o,this.bindInAttr=d,this.query=new Proxy({},{get:(e,t)=>{if("string"==typeof t)return e[t]?e[t]:e=>this._querySelect(/.*(\.|\#|\[|\]).*/gm.exec(t)?t:"#"+t)},set:(e,t,n,i)=>("string"==typeof n&&(n=()=>this._querySelect(n)),"string"==typeof t&&(e[t]=e=>n),!0)}),this.elements=new Proxy(this.query,{get:(e,t)=>e[t]()}),n&&Object.entries(n).forEach((e=>{this.query[e[0]]=e[1]})),this._values=new Proxy(i&&"object"==typeof i?i:{},{set:(e,t,n,i)=>(this.runRender({[t]:n}),e[t]=n,this.runConnections({[t]:n}),!0)}),this.onLoad=()=>{this.runRender({[!0]:!0}),this.runConnections(this.values)},h||(this._isJQuery?$(this.onLoad):window.onload=this.onLoad)}static toNodeArray(e){return"string"==typeof e||"number"==typeof e?[...a.parser.parseFromString(e.toString(),"text/html").body.childNodes]:NodeList.prototype.isPrototypeOf(e)||window.jQuery&&e instanceof jQuery?[...e]:Array.isArray(e)?e.filter((e=>"string"==typeof e||e instanceof Node)).map((e=>"string"==typeof e?a.toNodeArray(e)[0]:e)):e instanceof Node||e instanceof Document?[e]:void 0}static defaultParams({render:e=[],binds:t={},elements:n={},values:i={},bindAttr:r="d-bind",bindInAttr:s="d-bind-in",isJQuery:o=!1,connections:c=[],removeOnload:u=!1}={}){return{elements:n,values:i,render:e,binds:t,bindAttr:r,bindInAttr:s,isJQuery:o,connections:c,removeOnload:u}}set values(e){throw Error("Tried to set DocObject.value. Try creating a inner object instead.")}get values(){return this._values}isBindIn(e){return e.getAttribute(this.bindInAttr)&&!0}isBind(e){return("d-bind"===e.localName||e.getAttribute(this.bindAttr))&&!0}static isDobObjectElement(e){return e._DocObject instanceof a}findOrRegisterBind(e){if(void 0===e._DocObjectConfig){let t=[...e.childNodes];t.toString=()=>e.innerHTML,e._DocObjectConfig={originalChildren:t,originalChildrenHTML:e.innerHTML,originalAttributes:[...e.attributes].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.value})),{})}}return e._DocObjectConfig}generateBind(e,t,n){const i=e._DocObjectConfig,r=a.toNodeArray("function"==typeof n?n(this.g):n);if(this.isBind(e)){const e=r.find((e=>e instanceof HTMLElement));return e._DocObjectConfig=i,e.setAttribute("d-bind"===e.localName?"to":this.bindAttr,t),Object.entries(i.originalAttributes).filter((e=>!["d-bind-in","to"].includes(e[0]))).forEach((t=>e.setAttribute(t[0],t[1]))),e}return r}runRender(e={}){this.render.filter((t=>t.dep&&Array.isArray(t.dep)&&t.dep.some((t=>t in e))||void 0===t.dep)).forEach((t=>{t.clean&&t.clean(Object.assign(Object.assign({},this.values),e),this.values),t.action(Object.assign(Object.assign({},this.values),e),this.values)})),this.runBinds(this.root,e)}getBindAction(e){if(this.isBind(e)){if(e.getAttribute(this.bindAttr))return[e.getAttribute(this.bindAttr),t=>e.parentNode.replaceChild(t,e)];if("d-bind"===e.localName)return[e.getAttribute("to"),t=>e.parentNode.replaceChild(t,e)]}else if(this.isBindIn(e))return[e.getAttribute(this.bindInAttr),t=>{e.innerHTML="";for(let n of t)e.appendChild(n)}]}runBinds(e,t={}){return(Array.isArray(e)?e:[e]).filter((e=>e&&e instanceof HTMLElement)).forEach((e=>{[...e.querySelectorAll(`[${this.bindAttr}], [${this.bindInAttr}], d-bind[to]`)].forEach((e=>{const[n,i]=this.getBindAction(e);if(n in this.binds){const r=this.findOrRegisterBind(e);i(this.runBinds(this.generateBind(e,n,this.binds[n](Object.assign(Object.assign({},this.values),t),r.originalAttributes,r.originalChildren)),t))}}))})),e}runConnections(e={[!0]:!0}){for(let t in e)this._connections.forEach((n=>n.values[t]=e[t]))}connect(...e){return this._connections=[...this._connections,...e],this.runConnections(this.values),this}}t.DocObject=a,a.parser=new DOMParser},382:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JQUERY_NOT_DETECTED=t.ROOT_ERROR=void 0,t.ROOT_ERROR="ROOT_ERROR",t.JQUERY_NOT_DETECTED="JQUERY_NOT_DETECTED",t.default=function(e,t=!1){if(e in n){if(t)throw Error("DocObject: "+n[e].message);console.error(n[e].message)}};const n={ROOT_ERROR:{message:"Root Element Must be a valid Node, Or jQuery Element"},JQUERY_NOT_DETECTED:{message:"JQuery is not detected. Please load JQuery before DocObject"}}},294:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.gen=t.obj=t.fixInput=void 0;const r=n(391),s=i(n(360)),o=n(605);class c extends HTMLElement{constructor(){super()}}t.fixInput=function(e,t){let n=(0,o.getCursorPos)(e()[0]);t(),(0,o.setCursorPos)(e()[0],n)},window.customElements.define("d-bind",c),window.jQuery&&jQuery.fn.extend({DocObject:function(e=null){return this[0]._DocObject&&!e||(this.each((function(){new r.DocObject(this,e)})),new r.DocObject(this,Object.assign({isJQuery:!0},e))),this[0]._DocObject}}),t.obj=function(e,t){return new r.DocObject(e,t)},t.gen=function(){return new s.default}},605:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setCursorPos=t.getCursorPos=void 0,t.getCursorPos=function(e){return"backward"==e.selectionDirection?e.selectionStart:e.selectionEnd},t.setCursorPos=function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}}}},t={},n=function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}(294);Doc=n})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxHQUFZLENBR2pERSxRQUFTLElBT1YsT0FIQUUsRUFBb0JKLEdBQVVLLEtBQUtGLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNILEdBR3BFSSxFQUFPRCxRQ2xCV0gsQ0FBb0IsSyIsInNvdXJjZXMiOlsid2VicGFjazovL0RvYy8uL3NyYy90cy9kb2NnZW4udHMiLCJ3ZWJwYWNrOi8vRG9jLy4vc3JjL3RzL2RvY29iamVjdC50cyIsIndlYnBhY2s6Ly9Eb2MvLi9zcmMvdHMvZXJyb3JzLnRzIiwid2VicGFjazovL0RvYy8uL3NyYy90cy9pbmRleC50cyIsIndlYnBhY2s6Ly9Eb2MvLi9zcmMvdHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vRG9jL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0RvYy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEb2NPYmplY3QsIERvY09iamVjdEhUTUxMaWtlfSBmcm9tICcuL2RvY29iamVjdCdcclxuaW1wb3J0IHsgRG9jT2JqZWN0QmluZEF0dHJpYnV0ZSB9IGZyb20gJy4vZG9jYmluZCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERvY0dlbiB7XHJcbiAgICBcclxuICAgIG9iaiA/IDogRG9jT2JqZWN0IFxyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihvYmo/IDogRG9jT2JqZWN0KXtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm9iaiA9IG9ialxyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHRoaXMsIHtcclxuICAgICAgICAgICAgZ2V0Oih0YXJnZXQsIHByb3AgKSA9PiB7XHJcbiAgICAgICAgICAgICAgIHJldHVybiB0aGlzLkdlbihwcm9wIGFzIHN0cmluZylcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgR2VuKHByb3AgOiBzdHJpbmcpe1xyXG4gICAgICAgIHJldHVybiAoaW5uZXIgOiBEb2NPYmplY3RIVE1MTGlrZSB8IEFycmF5PHN0cmluZ3xOb2RlPiA9IFtdICwgYXR0cnMgOiBEb2NPYmplY3RCaW5kQXR0cmlidXRlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmKHRoaXMub2JqICYmIHByb3AgaW4gdGhpcy5vYmouYmluZHMpe1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYm91bmQgPSB0aGlzLm9iai5iaW5kc1twcm9wXSh0aGlzLm9iai52YWx1ZXMsIGF0dHJzLCBEb2NPYmplY3QudG9Ob2RlQXJyYXkoaW5uZXIpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBib3VuZCA9PT0gJ2Z1bmN0aW9uJyA/IGJvdW5kKHRoaXMub2JqLmcpIDogYm91bmQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHByb3ApXHJcbiAgICAgICAgICAgIGZvcihsZXQga2V5IGluIGF0dHJzKXtcclxuICAgICAgICAgICAgICAgIGlmKGtleSA9PT0gJ3N0eWxlJyAmJiB0eXBlb2YgYXR0cnNba2V5XSA9PT0gJ29iamVjdCcgKXtcclxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IHNrZXkgaW4gYXR0cnNba2V5IGFzIHN0cmluZ10pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlW3NrZXldID0gYXR0cnNba2V5XVtza2V5XVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihrZXkuc3RhcnRzV2l0aCgnb24nKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudFtrZXldID0gYXR0cnNba2V5XVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyc1trZXldKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIERvY09iamVjdC50b05vZGVBcnJheShpbm5lcikuZm9yRWFjaChpbmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChpbmUpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCB7IERvY09iamVjdERvbUJpbmQsIERvY09iamVjdEJpbmQsIERvY09iamVjdEJpbmRHZW4gfSBmcm9tICcuL2RvY2JpbmQnXHJcbmltcG9ydCB7IERvY09iamVjdFJlbmRlciB9IGZyb20gJy4vZG9jcmVuZGVyJ1xyXG5pbXBvcnQgIERvY0dlbiAgZnJvbSAnLi9kb2NnZW4nXHJcbmltcG9ydCBydW5FcnJvciwgeyBcclxuICAgIFJPT1RfRVJST1IsXHJcbiAgICBKUVVFUllfTk9UX0RFVEVDVEVEXHJcbn0gZnJvbSAnLi9lcnJvcnMnO1xyXG5cclxuLyoqKioqKiogR0xPQkFMUyAqKioqKioqL1xyXG5kZWNsYXJlIGdsb2JhbCB7XHJcbiAgICBpbnRlcmZhY2UgV2luZG93IHtcclxuICAgICAgICBqUXVlcnk6YW55O1xyXG4gICAgICAgIG1zQ3J5cHRvOmFueTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbi8qKioqKioqIERPQyBPQkpFQ1QgKioqKioqKi9cclxuZXhwb3J0IHR5cGUgRG9jT2JqZWN0SFRNTExpa2UgPSBcclxufCBOb2RlXHJcbnwgTm9kZUxpc3RcclxufCBKUXVlcnkgXHJcbnwgTnVtYmVyXHJcbnwgc3RyaW5nXHJcbnwgKChnZW46IERvY0dlbikgPT4gRG9jT2JqZWN0SFRNTExpa2UpO1xyXG5cclxuXHJcblxyXG5pbnRlcmZhY2UgRG9jT2JqZWN0T3B0aW9ucyB7XHJcbiAgICByZW5kZXIgOiBEb2NPYmplY3RSZW5kZXI7XHJcbiAgICBiaW5kcyA6IERvY09iamVjdEJpbmQgfCBEb2NPYmplY3RCaW5kR2VuO1xyXG4gICAgZWxlbWVudHMgOiB7W2tleTpzdHJpbmddOiBzdHJpbmd9O1xyXG4gICAgdmFsdWVzIDogb2JqZWN0O1xyXG4gICAgYmluZEF0dHIgOiBzdHJpbmc7XHJcbiAgICBiaW5kSW5BdHRyIDogc3RyaW5nO1xyXG4gICAgaXNKUXVlcnkgOiBib29sZWFuO1xyXG4gICAgY29ubmVjdGlvbnMgOiBBcnJheTxEb2NPYmplY3Q+XHJcbiAgICByZW1vdmVPbmxvYWQgOiBib29sZWFuXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRG9jT2JqZWN0RWxlbWVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgIF9Eb2NPYmplY3Q/IDogRG9jT2JqZWN0XHJcbn1cclxuXHJcbmludGVyZmFjZSBEb2NPYmplY3RFbGVtZW50cyB7XHJcbiAgICBba2V5OiBzdHJpbmddIDogc3RyaW5nIHwgKChzZWxlY3RvciA6IHN0cmluZyApID0+IE5vZGVMaXN0fEpRdWVyeSlcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEb2NPYmplY3RDb25maWcge1xyXG4gICAgb3JpZ2luYWxDaGlsZHJlbjogQXJyYXk8Tm9kZT47XHJcbiAgICBvcmlnaW5hbENoaWxkcmVuSFRNTDogc3RyaW5nO1xyXG4gICAgb3JpZ2luYWxBdHRyaWJ1dGVzOiB7W2tleTpzdHJpbmddIDogc3RyaW5nfTtcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBEb2NPYmplY3Qge1xyXG5cclxuICAgIHN0YXRpYyBwYXJzZXIgOiBET01QYXJzZXIgPSBuZXcgRE9NUGFyc2VyKClcclxuXHJcbiAgICBzdGF0aWMgdG9Ob2RlQXJyYXkoYW55IDogRG9jT2JqZWN0SFRNTExpa2UgfCBBcnJheTxzdHJpbmd8Tm9kZT4gKSA6IEFycmF5PE5vZGU+IHtcclxuICAgICAgICBpZih0eXBlb2YgYW55ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgYW55ID09PSAnbnVtYmVyJyl7XHJcbiAgICAgICAgICAgIHJldHVybiBbLi4uRG9jT2JqZWN0LnBhcnNlci5wYXJzZUZyb21TdHJpbmcoYW55LnRvU3RyaW5nKCksICd0ZXh0L2h0bWwnKS5ib2R5LmNoaWxkTm9kZXNdXHJcbiAgICAgICAgfWVsc2UgaWYoTm9kZUxpc3QucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoYW55KSB8fCAod2luZG93LmpRdWVyeSAmJiBhbnkgaW5zdGFuY2VvZiBqUXVlcnkpKXtcclxuICAgICAgICAgICAgcmV0dXJuIFsgLi4uKGFueSBhcyBOb2RlTGlzdCldXHJcbiAgICAgICAgfWVsc2UgaWYoQXJyYXkuaXNBcnJheShhbnkpKXtcclxuICAgICAgICAgICAgcmV0dXJuIGFueVxyXG4gICAgICAgICAgICAuZmlsdGVyKGU9PiAodHlwZW9mIGUgPT09ICdzdHJpbmcnKSB8fCBlIGluc3RhbmNlb2YgTm9kZSApXHJcbiAgICAgICAgICAgIC5tYXAoZT0+ICh0eXBlb2YgZSA9PT0gJ3N0cmluZycpID8gRG9jT2JqZWN0LnRvTm9kZUFycmF5KGUpWzBdIDogZSApO1xyXG4gICAgICAgIH0gZWxzZSBpZihhbnkgaW5zdGFuY2VvZiBOb2RlIHx8IGFueSBpbnN0YW5jZW9mIERvY3VtZW50ICl7XHJcbiAgICAgICAgICAgIHJldHVybiBbYW55XVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgZGVmYXVsdFBhcmFtcyh7XHJcbiAgICAgICAgcmVuZGVyID0gW10sXHJcbiAgICAgICAgYmluZHMgPSB7fSxcclxuICAgICAgICBlbGVtZW50cyA9IHt9LFxyXG4gICAgICAgIHZhbHVlcyA9IHt9LFxyXG4gICAgICAgIGJpbmRBdHRyID0gJ2QtYmluZCcsXHJcbiAgICAgICAgYmluZEluQXR0ciA9ICdkLWJpbmQtaW4nLFxyXG4gICAgICAgIGlzSlF1ZXJ5ID0gZmFsc2UsXHJcbiAgICAgICAgY29ubmVjdGlvbnMgPSBbXSxcclxuICAgICAgICByZW1vdmVPbmxvYWQgPSBmYWxzZVxyXG4gICAgfSA9IHt9KSA6IERvY09iamVjdE9wdGlvbnMge1xyXG4gICAgICAgIHJldHVybiAgeyBlbGVtZW50cywgdmFsdWVzLCByZW5kZXIsIGJpbmRzLCBiaW5kQXR0ciwgYmluZEluQXR0ciwgaXNKUXVlcnksIGNvbm5lY3Rpb25zLCByZW1vdmVPbmxvYWQgfSBcclxuICAgIH1cclxuXHJcblxyXG5cclxuXHJcbiAgICByZWFkb25seSBfdmFsdWVzIDogb2JqZWN0O1xyXG4gICAgZWxlbWVudHMgOiBQcm94eUhhbmRsZXI8RG9jT2JqZWN0RWxlbWVudHM+O1xyXG4gICAgcm9vdCA6IERvY09iamVjdEVsZW1lbnQ7XHJcbiAgICByZW5kZXIgOiBEb2NPYmplY3RSZW5kZXI7XHJcbiAgICBiaW5kcyA6IERvY09iamVjdEJpbmQ7XHJcbiAgICBiaW5kQXR0ciA6IHN0cmluZztcclxuICAgIGJpbmRJbkF0dHIgOiBzdHJpbmc7XHJcbiAgICBxdWVyeSA6IFByb3h5SGFuZGxlcjxEb2NPYmplY3RFbGVtZW50cz47XHJcbiAgICBfcXVlcnlTZWxlY3QgOiAoc2VsZWN0b3I6c3RyaW5nKT0+IE5vZGVMaXN0IHwgSlF1ZXJ5O1xyXG4gICAgX2lzSlF1ZXJ5IDogYm9vbGVhblxyXG4gICAgX2Nvbm5lY3Rpb25zIDogQXJyYXk8RG9jT2JqZWN0PlxyXG4gICAgZyA6IERvY0dlblxyXG4gICAgb25Mb2FkOiAoKT0+dm9pZFxyXG5cclxuICAgIHNldCB2YWx1ZXModmFsdWVzKSB7XHJcbiAgICAgICAgdGhyb3cgRXJyb3IoXCJUcmllZCB0byBzZXQgRG9jT2JqZWN0LnZhbHVlLiBUcnkgY3JlYXRpbmcgYSBpbm5lciBvYmplY3QgaW5zdGVhZC5cIilcclxuICAgIH1cclxuICAgIGdldCB2YWx1ZXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlcztcclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3Rvcihyb290IDogRG9jT2JqZWN0RWxlbWVudCB8IEpRdWVyeSwgb3B0aW9ucyA6IG9iamVjdCkge1xyXG4gICAgICAgIC8vQWRkIERlZmF1bHQgUGFyYW1ldGVycyB0byBvcHRpb25zXHJcbiAgICAgICAgY29uc3QgeyBlbGVtZW50cywgdmFsdWVzLCByZW5kZXIsIGJpbmRzLCBiaW5kQXR0ciwgYmluZEluQXR0ciwgaXNKUXVlcnksIGNvbm5lY3Rpb25zLCByZW1vdmVPbmxvYWQgfSA6IERvY09iamVjdE9wdGlvbnMgPSBEb2NPYmplY3QuZGVmYXVsdFBhcmFtcyhvcHRpb25zKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vRXh0cmFjdCBET00gZWxlbWVudCBmcm9tIEhUTUxFbGVtZW50IE9yIEpxdWVyeSBPYmplY3RcclxuICAgICAgICBsZXQgcm9vdEVsZW1lbnQgPSBEb2NPYmplY3QudG9Ob2RlQXJyYXkocm9vdClbMF1cclxuICAgICAgICBcclxuICAgICAgICAvL1NldCBSb290IE9iamVjdFxyXG4gICAgICAgIGlmKHJvb3RFbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgKXtcclxuICAgICAgICAgICAgdGhpcy5yb290ID0gcm9vdEVsZW1lbnRcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcnVuRXJyb3IoUk9PVF9FUlJPUiwgdHJ1ZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX2Nvbm5lY3Rpb25zID0gY29ubmVjdGlvbnM7XHJcblxyXG4gICAgICAgIC8vU2V0IEpxdWVyeVxyXG4gICAgICAgIGlmKGlzSlF1ZXJ5ICYmIHdpbmRvdy5qUXVlcnkpe1xyXG4gICAgICAgICAgICAvL0lmIEpxdWVyeSBpcyBkZXRlY3RlZCBhbmQgaXMgc2V0IHRvIGpxdWVyeSBtb2RlLi4uXHJcbiAgICAgICAgICAgIHRoaXMuX2lzSlF1ZXJ5ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIC8vU2V0IFF1ZXJ5IFNlbGVjdCBzdGF0ZW1lbnQgdG8gdXNlIGpRdWVyeVxyXG4gICAgICAgICAgICB0aGlzLl9xdWVyeVNlbGVjdCA9ICguLi5wcm9wcykgPT4gJCh0aGlzLnJvb3QpLmZpbmQoLi4ucHJvcHMpXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgICAgICAvL0lmIEpxdWVyeSBpcyBub3QgZGV0ZWN0ZWQuLi5cclxuICAgICAgICAgICAgaWYoaXNKUXVlcnkpe1xyXG4gICAgICAgICAgICAgICAgLy9JZiBzZXQgdG8ganF1ZXJ5IG1vZGUuLi5cclxuICAgICAgICAgICAgICAgIHJ1bkVycm9yKEpRVUVSWV9OT1RfREVURUNURUQsIGZhbHNlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vU2V0IFF1ZXJ5IFNlbGVjdCBzdGF0ZW1lbnQgdG8gdXNlIEhUTUxFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGxcclxuICAgICAgICAgICAgdGhpcy5faXNKUXVlcnkgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fcXVlcnlTZWxlY3QgPSAoLi4ucHJvcHMpID0+IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yQWxsKC4uLnByb3BzKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9TZXQgUm9vdCBPYmplY3QgdG8gdGhpc1xyXG4gICAgICAgIHRoaXMucm9vdC5fRG9jT2JqZWN0ID0gdGhpcztcclxuXHJcbiAgICAgICAgLy9TZXQgUmVuZGVyIEZ1bmN0aW9uc1xyXG4gICAgICAgIHRoaXMucmVuZGVyID0gcmVuZGVyO1xyXG5cclxuICAgICAgICAvL0NyZWF0ZSBSZWxhdGVkIERvY0dlblxyXG4gICAgICAgIHRoaXMuZyA9IG5ldyBEb2NHZW4odGhpcylcclxuXHJcbiAgICAgICAgLy9TZXQgQmluZCBGdW5jdGlvbnNcclxuICAgICAgICB0aGlzLmJpbmRzID0gKHR5cGVvZiBiaW5kcyA9PT0gJ2Z1bmN0aW9uJykgPyBiaW5kcyh0aGlzLmcpIDogYmluZHMgO1xyXG5cclxuICAgICAgICAvL1NldCBCaW5kIEF0dHJpYnV0ZVxyXG4gICAgICAgIHRoaXMuYmluZEF0dHIgPSBiaW5kQXR0cjtcclxuXHJcbiAgICAgICAgLy9TZXQgQmluZCBJbiBBdHRyaWJ1dGVcclxuICAgICAgICB0aGlzLmJpbmRJbkF0dHIgPSBiaW5kSW5BdHRyO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vU2V0IFF1ZXJ5IFByb3h5XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IG5ldyBQcm94eSh7fSwge1xyXG4gICAgICAgICAgICBnZXQ6ICh0YXJnZXQsIHByb3AgKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZih0eXBlb2YgcHJvcCA9PSAnc3RyaW5nJylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIHRhcmdldFtwcm9wXSA/IHRhcmdldFtwcm9wXSA6IF8gPT4gdGhpcy5fcXVlcnlTZWxlY3QoIC8uKihcXC58XFwjfFxcW3xcXF0pLiovZ20uZXhlYyhwcm9wKSA/IHByb3AgOiAnIycgKyBwcm9wICkgXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldDogKHRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykgdmFsdWUgPSAoKSA9PiB0aGlzLl9xdWVyeVNlbGVjdCh2YWx1ZSlcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycpe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IF8gPT4gdmFsdWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIC8vU2V0IEVsZW1lbnRzIFByb3h5XHJcbiAgICAgICAgdGhpcy5lbGVtZW50cyA9IG5ldyBQcm94eSh0aGlzLnF1ZXJ5LCB7XHJcbiAgICAgICAgICAgIGdldDogKHRhcmdldCwgcHJvcCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRhcmdldFtwcm9wXSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvL0FkZCBpbiBlbGVtZW50cyBmcm9tIG9wdGlvbnNcclxuICAgICAgICBpZiAoZWxlbWVudHMpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoZWxlbWVudHMpLmZvckVhY2goKGUgPT4geyB0aGlzLnF1ZXJ5W2VbMF1dID0gZVsxXSB9KSlcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICB0aGlzLl92YWx1ZXMgPSBuZXcgUHJveHkoIXZhbHVlcyB8fCB0eXBlb2YgdmFsdWVzICE9PSAnb2JqZWN0JyA/IHt9IDogdmFsdWVzLCB7XHJcbiAgICAgICAgICAgIHNldDogKHRhcmdldCwgcHJvcCwgdmFsdWUsIHJlY2VpdmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJ1blJlbmRlcih7IFtwcm9wXTogdmFsdWUgfSlcclxuICAgICAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ydW5Db25uZWN0aW9ucyh7W3Byb3BdOnZhbHVlfSlcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICBcclxuICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMub25Mb2FkID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJ1blJlbmRlcih7IFt0cnVlIGFzIGFueV06IHRydWUgfSlcclxuICAgICAgICAgICAgdGhpcy5ydW5Db25uZWN0aW9ucyh0aGlzLnZhbHVlcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCFyZW1vdmVPbmxvYWQpe1xyXG4gICAgICAgICAgICBpZih0aGlzLl9pc0pRdWVyeSl7XHJcbiAgICAgICAgICAgICAgICAkKHRoaXMub25Mb2FkKVxyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5vbmxvYWQgPSB0aGlzLm9uTG9hZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBpc0JpbmRJbihlbGVtZW50IDogRG9jT2JqZWN0RG9tQmluZCkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKCBlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLmJpbmRJbkF0dHIpICYmIHRydWUgKSBcclxuICAgIH1cclxuICAgIGlzQmluZChlbGVtZW50IDogRG9jT2JqZWN0RG9tQmluZCkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKGVsZW1lbnQubG9jYWxOYW1lID09PSAnZC1iaW5kJyB8fCBlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLmJpbmRBdHRyKSkgJiYgdHJ1ZVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGlzRG9iT2JqZWN0RWxlbWVudChlbGVtZW50IDogRG9jT2JqZWN0RWxlbWVudCApIDogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICggZWxlbWVudC5fRG9jT2JqZWN0IGluc3RhbmNlb2YgRG9jT2JqZWN0ICApXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGZpbmRPclJlZ2lzdGVyQmluZChET01lbGVtZW50IDogRG9jT2JqZWN0RG9tQmluZCkgOiBEb2NPYmplY3RDb25maWcge1xyXG4gICAgICAgIGlmKERPTWVsZW1lbnQuX0RvY09iamVjdENvbmZpZyA9PT0gdW5kZWZpbmVkKXtcclxuICAgICAgICAgICAgbGV0IG9yaWdpbmFsQ2hpbGRyZW4gPSBbLi4uRE9NZWxlbWVudC5jaGlsZE5vZGVzXVxyXG4gICAgICAgICAgICBvcmlnaW5hbENoaWxkcmVuLnRvU3RyaW5nID0gKCk9PiBET01lbGVtZW50LmlubmVySFRNTFxyXG4gICAgICAgICAgICBET01lbGVtZW50Ll9Eb2NPYmplY3RDb25maWcgPSB7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbENoaWxkcmVuLFxyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxDaGlsZHJlbkhUTUw6IERPTWVsZW1lbnQuaW5uZXJIVE1MLFxyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxBdHRyaWJ1dGVzOiBbLi4uRE9NZWxlbWVudC5hdHRyaWJ1dGVzXS5yZWR1Y2UoIChhLGMpPT57cmV0dXJuIHsuLi5hLCBbYy5uYW1lXTpjLnZhbHVlfSB9LCB7fSApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIERPTWVsZW1lbnQuX0RvY09iamVjdENvbmZpZ1xyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlQmluZChlbGVtZW50IDogRG9jT2JqZWN0RG9tQmluZCwgYmluZCwgYm91bmQgOiBEb2NPYmplY3RIVE1MTGlrZSkgOiBEb2NPYmplY3REb21CaW5kIHwgTm9kZVtdIHtcclxuICAgICAgICBjb25zdCBjb25maWcgPSBlbGVtZW50Ll9Eb2NPYmplY3RDb25maWc7XHJcbiAgICAgICAgY29uc3Qgbm9kZUFycmF5ID0gRG9jT2JqZWN0LnRvTm9kZUFycmF5KHR5cGVvZiBib3VuZCA9PT0gJ2Z1bmN0aW9uJyA/IGJvdW5kKHRoaXMuZykgOiBib3VuZCk7XHJcbiAgICAgICAgaWYodGhpcy5pc0JpbmQoZWxlbWVudCkpe1xyXG4gICAgICAgICAgICBjb25zdCBmaXJzdEVsZW1lbnQgPSBub2RlQXJyYXkuZmluZChlbCA9PiBlbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSBhcyBEb2NPYmplY3REb21CaW5kO1xyXG4gICAgICAgICAgICBmaXJzdEVsZW1lbnQuX0RvY09iamVjdENvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICAgICAgZmlyc3RFbGVtZW50LnNldEF0dHJpYnV0ZSgoZmlyc3RFbGVtZW50LmxvY2FsTmFtZSA9PT0gJ2QtYmluZCcgPyAndG8nIDogdGhpcy5iaW5kQXR0ciksIGJpbmQpXHJcbiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGNvbmZpZy5vcmlnaW5hbEF0dHJpYnV0ZXMpLmZpbHRlcihhdHRBPT4hKFsnZC1iaW5kLWluJywgJ3RvJ10uaW5jbHVkZXMoYXR0QVswXSkpKS5mb3JFYWNoKGF0dEE9PmZpcnN0RWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0QVswXSwgYXR0QVsxXSkpXHJcbiAgICAgICAgICAgIHJldHVybiBmaXJzdEVsZW1lbnQ7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiBub2RlQXJyYXk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFxyXG5cclxuICAgIHJ1blJlbmRlcih2YWx1ZUNoYW5nZXMgPSB7fSkgOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJlbmRlci5maWx0ZXIocmVuID0+IChyZW4uZGVwICYmIEFycmF5LmlzQXJyYXkocmVuLmRlcCkgJiYgcmVuLmRlcC5zb21lKChkZXBwKSA9PiAoZGVwcCBpbiB2YWx1ZUNoYW5nZXMpKSkgfHwgKHJlbi5kZXAgPT09IHVuZGVmaW5lZCkpLmZvckVhY2gocmVuID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlbi5jbGVhbikgcmVuLmNsZWFuKHsgLi4udGhpcy52YWx1ZXMsIC4uLnZhbHVlQ2hhbmdlcyB9LCB0aGlzLnZhbHVlcylcclxuICAgICAgICAgICAgcmVuLmFjdGlvbih7IC4uLnRoaXMudmFsdWVzLCAuLi52YWx1ZUNoYW5nZXMgfSwgdGhpcy52YWx1ZXMpXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLnJ1bkJpbmRzKHRoaXMucm9vdCwgdmFsdWVDaGFuZ2VzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRCaW5kQWN0aW9uKGVsZW1lbnQgOiBIVE1MRWxlbWVudCkgOiBbc3RyaW5nLCAocmVwbGFjZSA6IE5vZGUgJiBOb2RlTGlzdCApPT52b2lkXSB7XHJcbiAgICAgICAgaWYodGhpcy5pc0JpbmQoZWxlbWVudCkpe1xyXG4gICAgICAgICAgICBpZihlbGVtZW50LmdldEF0dHJpYnV0ZSh0aGlzLmJpbmRBdHRyKSl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2VsZW1lbnQuZ2V0QXR0cmlidXRlKHRoaXMuYmluZEF0dHIpLCAocmVwbGFjZSk9PmVsZW1lbnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQocmVwbGFjZSwgZWxlbWVudCldXHJcbiAgICAgICAgICAgIH1lbHNlIGlmKGVsZW1lbnQubG9jYWxOYW1lID09PSAnZC1iaW5kJyl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2VsZW1lbnQuZ2V0QXR0cmlidXRlKCd0bycpLCAocmVwbGFjZSk9PmVsZW1lbnQucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQocmVwbGFjZSwgZWxlbWVudCldXHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfWVsc2UgaWYodGhpcy5pc0JpbmRJbihlbGVtZW50KSl7XHJcbiAgICAgICAgICAgIHJldHVybiBbZWxlbWVudC5nZXRBdHRyaWJ1dGUodGhpcy5iaW5kSW5BdHRyKSwgKHJlcGxhY2UpPT57XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgbm9kZSBvZiByZXBsYWNlKSBlbGVtZW50LmFwcGVuZENoaWxkKG5vZGUpO1xyXG4gICAgICAgICAgICB9XVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHF1ZXJ5U2VsZWN0b3JBbGwgPSAoc2VsZWN0b3IgOiBzdHJpbmcpID0+IHRoaXMucm9vdC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKVxyXG4gICAgcnVuQmluZHMocm9vdCwgdmFsdWVDaGFuZ2VzID0ge30pIHtcclxuICAgICAgICAoQXJyYXkuaXNBcnJheShyb290KSA/IHJvb3QgOiBbcm9vdF0pIFxyXG4gICAgICAgIC5maWx0ZXIocnQ9PnJ0ICYmIHJ0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgLmZvckVhY2goKHJ0KT0+e1xyXG4gICAgICAgICAgICBbIC4uLihydC5xdWVyeVNlbGVjdG9yQWxsKGBbJHt0aGlzLmJpbmRBdHRyfV0sIFske3RoaXMuYmluZEluQXR0cn1dLCBkLWJpbmRbdG9dYCkpIF0gXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKCBlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIC8vR2V0IFRoZSBCaW5kIE1ldGhvZCwgYW5kIHRoZSBGdW5jdGlvbiB0byBpbnNlcnQgSFRNTCBcclxuICAgICAgICAgICAgICAgIGNvbnN0IFtiaW5kLCBiaW5kQWN0aW9uXSA9IHRoaXMuZ2V0QmluZEFjdGlvbihlbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgLy9DaGVjayBpZiBCaW5kIEV4aXN0cyBcclxuICAgICAgICAgICAgICAgIGlmIChiaW5kIGluIHRoaXMuYmluZHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9HZXQgT3IgcmVnaXN0ZXIgQmluZCBUYWcncyBDb25maWdcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5maW5kT3JSZWdpc3RlckJpbmQoZWxlbWVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSW5zZXJ0IEhUTUxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYmluZEFjdGlvbih0aGlzLnJ1bkJpbmRzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1dyYXAgQmluZCBNZXRob2QgdG8gcHJlcGFyZSBiaW5kIGZvciBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUJpbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmluZCwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SdW4gQmluZCBNZXRob2RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRzW2JpbmRdKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IC4uLnRoaXMudmFsdWVzLCAuLi52YWx1ZUNoYW5nZXMgfSwgLy9QYXNzIGluIHVwZGF0ZXMgdmFsdWVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5vcmlnaW5hbEF0dHJpYnV0ZXMsIC8vUGFzcyBpbiBvcmlnaW5hbCBhdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5vcmlnaW5hbENoaWxkcmVuLCAvL1Bhc3MgaW4gb3JpZ2luYWwgY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gcm9vdDtcclxuICAgIH1cclxuXHJcbiAgICBydW5Db25uZWN0aW9ucyh2YWx1ZUNoYW5nZXMgOiB7W2tleSA6IHN0cmluZ3xzeW1ib2xdIDogYW55IH0gPSB7W3RydWUgYXMgYW55XTp0cnVlfSApe1xyXG4gICAgICAgIGZvcihsZXQga3kgaW4gdmFsdWVDaGFuZ2VzKXtcclxuICAgICAgICAgICAgdGhpcy5fY29ubmVjdGlvbnMuZm9yRWFjaCgoY29ubmVjdGVkKSA9PiBjb25uZWN0ZWQudmFsdWVzW2t5XSA9IHZhbHVlQ2hhbmdlc1treV0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBjb25uZWN0KC4uLmRvY09iamVjdHMgOiBbRG9jT2JqZWN0XSl7XHJcbiAgICAgICAgdGhpcy5fY29ubmVjdGlvbnMgPSBbLi4udGhpcy5fY29ubmVjdGlvbnMsIC4uLmRvY09iamVjdHNdXHJcbiAgICAgICAgdGhpcy5ydW5Db25uZWN0aW9ucyh0aGlzLnZhbHVlcyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5cclxuLypcclxudmFyIGRvYyA9IG5ldyBEb2NPYmplY3Qoe1xyXG4gICAgdmFsdWVzOiB7XHJcbiAgICB9LFxyXG4gICAgZWxlbWVudHM6e1xyXG5cclxuICAgIH0sXHJcbiAgICBiaW5kczp7XHJcblxyXG4gICAgfSxcclxuICAgIHJlbmRlcjogW1xyXG5cclxuICAgIF1cclxufSk7ICQoZG9jLm9uTG9hZClcclxuKi8iLCJcclxuXHJcbmV4cG9ydCBjb25zdCBST09UX0VSUk9SID0gJ1JPT1RfRVJST1InXHJcbmV4cG9ydCBjb25zdCBKUVVFUllfTk9UX0RFVEVDVEVEID0gJ0pRVUVSWV9OT1RfREVURUNURUQnXHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcnVuRXJyb3IoZXJyb3IgOiBzdHJpbmcsIGZhaWw9ZmFsc2Upe1xyXG4gICAgaWYoZXJyb3IgaW4gRVJST1JTKXtcclxuICAgICAgICBpZihmYWlsKXtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0RvY09iamVjdDogJysgRVJST1JTW2Vycm9yXS5tZXNzYWdlKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihFUlJPUlNbZXJyb3JdLm1lc3NhZ2UpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBFUlJPUlMgPSB7XHJcbiAgICBST09UX0VSUk9SIDoge1xyXG4gICAgICAgIG1lc3NhZ2U6IFwiUm9vdCBFbGVtZW50IE11c3QgYmUgYSB2YWxpZCBOb2RlLCBPciBqUXVlcnkgRWxlbWVudFwiXHJcbiAgICB9LFxyXG4gICAgSlFVRVJZX05PVF9ERVRFQ1RFRDoge1xyXG4gICAgICAgIG1lc3NhZ2UgOiBcIkpRdWVyeSBpcyBub3QgZGV0ZWN0ZWQuIFBsZWFzZSBsb2FkIEpRdWVyeSBiZWZvcmUgRG9jT2JqZWN0XCJcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBEb2NPYmplY3QsIERvY09iamVjdEVsZW1lbnQgfSBmcm9tIFwiLi9kb2NvYmplY3RcIjtcclxuaW1wb3J0IERvY0dlbiBmcm9tIFwiLi9kb2NnZW5cIjtcclxuaW1wb3J0IHtzZXRDdXJzb3JQb3MsIGdldEN1cnNvclBvc30gZnJvbSBcIi4vdXRpbHNcIlxyXG5cclxuY2xhc3MgQmluZCBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKClcclxuICAgIH1cclxufVxyXG5cclxuLyoqKioqKiogVVRJTElUWSBNRVRIT0RTICoqKioqKiovXHJcbmV4cG9ydCBmdW5jdGlvbiBmaXhJbnB1dChzZWxlY3RvciwgYWN0aW9uKXtcclxuICAgIGxldCBwb3MgPSBnZXRDdXJzb3JQb3Moc2VsZWN0b3IoKVswXSlcclxuICAgIGFjdGlvbigpXHJcbiAgICBzZXRDdXJzb3JQb3Moc2VsZWN0b3IoKVswXSwgcG9zKVxyXG59XHJcblxyXG5cclxud2luZG93LmN1c3RvbUVsZW1lbnRzLmRlZmluZSgnZC1iaW5kJywgQmluZClcclxuaWYod2luZG93LmpRdWVyeSl7XHJcbiAgICAoZnVuY3Rpb24oJCkge1xyXG4gICAgICAgICQuZm4uZXh0ZW5kKHtcclxuICAgICAgICAgICAgRG9jT2JqZWN0IDogZnVuY3Rpb24oIG9wdGlvbnMgPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzWzBdLl9Eb2NPYmplY3QgJiYgIW9wdGlvbnMgKSByZXR1cm4gdGhpc1swXS5fRG9jT2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBEb2NPYmplY3QodGhpcywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG5ldyBEb2NPYmplY3QodGhpcywgeyBpc0pRdWVyeTp0cnVlLCAuLi5vcHRpb25zIH0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1swXS5fRG9jT2JqZWN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pKGpRdWVyeSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBvYmoocm9vdCA6IERvY09iamVjdEVsZW1lbnQgfCBKUXVlcnksIG9wdGlvbnMgOiBvYmplY3QpIDogRG9jT2JqZWN0e1xyXG4gICAgcmV0dXJuIG5ldyBEb2NPYmplY3Qocm9vdCwgb3B0aW9ucylcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbigpIDogRG9jR2VuIHtcclxuICAgIHJldHVybiBuZXcgRG9jR2VuKClcclxufVxyXG4iLCJpbnRlcmZhY2UgRG9jdW1lbnQge1xyXG4gICAgc2VsZWN0aW9uOiB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIENyZWRpdHM6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzI4OTcxNTUvZ2V0LWN1cnNvci1wb3NpdGlvbi1pbi1jaGFyYWN0ZXJzLXdpdGhpbi1hLXRleHQtaW5wdXQtZmllbGRcclxuIGV4cG9ydCBmdW5jdGlvbiBnZXRDdXJzb3JQb3MoZWxlbWVudCA6IEhUTUxJbnB1dEVsZW1lbnQpIDogbnVtYmVyIHtcclxuICAgIC8vIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcclxuICAgIC8vICAgICBlbGVtZW50LmZvY3VzKCk7XHJcbiAgICAvLyAgICAgcmV0dXJuICBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIC1lbGVtZW50LnZhbHVlLmxlbmd0aCk7XHJcbiAgICAvLyB9XHJcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQuc2VsZWN0aW9uRGlyZWN0aW9uID09ICdiYWNrd2FyZCcgPyBlbGVtZW50LnNlbGVjdGlvblN0YXJ0IDogZWxlbWVudC5zZWxlY3Rpb25FbmQ7XHJcbn1cclxuXHJcbi8vIENyZWRpdHM6IGh0dHA6Ly9ibG9nLnZpc2hhbG9uLm5ldC9pbmRleC5waHAvamF2YXNjcmlwdC1nZXR0aW5nLWFuZC1zZXR0aW5nLWNhcmV0LXBvc2l0aW9uLWluLXRleHRhcmVhL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0Q3Vyc29yUG9zKGVsZW1lbnQgOiBIVE1MSW5wdXRFbGVtZW50LCBwb3MgOiBudW1iZXIpIDogdm9pZCB7XHJcbiAgICAvLyBNb2Rlcm4gYnJvd3NlcnNcclxuICAgIGlmIChlbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKSB7XHJcbiAgICBlbGVtZW50LmZvY3VzKCk7XHJcbiAgICBlbGVtZW50LnNldFNlbGVjdGlvblJhbmdlKHBvcywgcG9zKTtcclxuICAgIFxyXG4gICAgLy8gSUU4IGFuZCBiZWxvd1xyXG4gICAgfSBlbHNlIGlmICgoZWxlbWVudCBhcyBhbnkpLmNyZWF0ZVRleHRSYW5nZSkge1xyXG4gICAgICB2YXIgcmFuZ2UgPSAoZWxlbWVudCBhcyBhbnkpLmNyZWF0ZVRleHRSYW5nZSgpO1xyXG4gICAgICByYW5nZS5jb2xsYXBzZSh0cnVlKTtcclxuICAgICAgcmFuZ2UubW92ZUVuZCgnY2hhcmFjdGVyJywgcG9zKTtcclxuICAgICAgcmFuZ2UubW92ZVN0YXJ0KCdjaGFyYWN0ZXInLCBwb3MpO1xyXG4gICAgICByYW5nZS5zZWxlY3QoKTtcclxuICAgIH1cclxufSIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMjk0KTtcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIm9iaiIsInRoaXMiLCJQcm94eSIsImdldCIsInRhcmdldCIsInByb3AiLCJHZW4iLCJpbm5lciIsImF0dHJzIiwiYmluZHMiLCJib3VuZCIsInZhbHVlcyIsIkRvY09iamVjdCIsInRvTm9kZUFycmF5IiwiZyIsImVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJrZXkiLCJza2V5Iiwic3R5bGUiLCJzdGFydHNXaXRoIiwic2V0QXR0cmlidXRlIiwiZm9yRWFjaCIsImluZSIsImFwcGVuZENoaWxkIiwicm9vdCIsIm9wdGlvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2VsZWN0b3IiLCJlbGVtZW50cyIsInJlbmRlciIsImJpbmRBdHRyIiwiYmluZEluQXR0ciIsImlzSlF1ZXJ5IiwiY29ubmVjdGlvbnMiLCJyZW1vdmVPbmxvYWQiLCJkZWZhdWx0UGFyYW1zIiwicm9vdEVsZW1lbnQiLCJIVE1MRWxlbWVudCIsIlJPT1RfRVJST1IiLCJfY29ubmVjdGlvbnMiLCJ3aW5kb3ciLCJqUXVlcnkiLCJfaXNKUXVlcnkiLCJfcXVlcnlTZWxlY3QiLCJwcm9wcyIsIiQiLCJmaW5kIiwiSlFVRVJZX05PVF9ERVRFQ1RFRCIsIl9Eb2NPYmplY3QiLCJxdWVyeSIsIl8iLCJleGVjIiwic2V0IiwidmFsdWUiLCJyZWNlaXZlciIsIk9iamVjdCIsImVudHJpZXMiLCJlIiwiX3ZhbHVlcyIsInJ1blJlbmRlciIsInJ1bkNvbm5lY3Rpb25zIiwib25Mb2FkIiwib25sb2FkIiwic3RhdGljIiwiYW55IiwicGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwidG9TdHJpbmciLCJib2R5IiwiY2hpbGROb2RlcyIsIk5vZGVMaXN0IiwicHJvdG90eXBlIiwiaXNQcm90b3R5cGVPZiIsIkFycmF5IiwiaXNBcnJheSIsImZpbHRlciIsIk5vZGUiLCJtYXAiLCJEb2N1bWVudCIsIkVycm9yIiwiaXNCaW5kSW4iLCJnZXRBdHRyaWJ1dGUiLCJpc0JpbmQiLCJsb2NhbE5hbWUiLCJmaW5kT3JSZWdpc3RlckJpbmQiLCJET01lbGVtZW50IiwidW5kZWZpbmVkIiwiX0RvY09iamVjdENvbmZpZyIsIm9yaWdpbmFsQ2hpbGRyZW4iLCJpbm5lckhUTUwiLCJvcmlnaW5hbENoaWxkcmVuSFRNTCIsIm9yaWdpbmFsQXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJyZWR1Y2UiLCJhIiwiYyIsIm5hbWUiLCJnZW5lcmF0ZUJpbmQiLCJiaW5kIiwiY29uZmlnIiwibm9kZUFycmF5IiwiZmlyc3RFbGVtZW50IiwiZWwiLCJhdHRBIiwiaW5jbHVkZXMiLCJ2YWx1ZUNoYW5nZXMiLCJyZW4iLCJkZXAiLCJzb21lIiwiZGVwcCIsImNsZWFuIiwiYWN0aW9uIiwicnVuQmluZHMiLCJnZXRCaW5kQWN0aW9uIiwicmVwbGFjZSIsInBhcmVudE5vZGUiLCJyZXBsYWNlQ2hpbGQiLCJub2RlIiwicnQiLCJiaW5kQWN0aW9uIiwia3kiLCJjb25uZWN0ZWQiLCJjb25uZWN0IiwiZG9jT2JqZWN0cyIsIkRPTVBhcnNlciIsImVycm9yIiwiZmFpbCIsIkVSUk9SUyIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiQmluZCIsInN1cGVyIiwicG9zIiwiZ2V0Q3Vyc29yUG9zIiwic2V0Q3Vyc29yUG9zIiwiY3VzdG9tRWxlbWVudHMiLCJkZWZpbmUiLCJmbiIsImV4dGVuZCIsImVhY2giLCJzZWxlY3Rpb25EaXJlY3Rpb24iLCJzZWxlY3Rpb25TdGFydCIsInNlbGVjdGlvbkVuZCIsInNldFNlbGVjdGlvblJhbmdlIiwiZm9jdXMiLCJjcmVhdGVUZXh0UmFuZ2UiLCJyYW5nZSIsImNvbGxhcHNlIiwibW92ZUVuZCIsIm1vdmVTdGFydCIsInNlbGVjdCIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19leHBvcnRzX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9